import{aI as D,aM as St,aN as Ot}from"./vendor-ngDrVcqS.js";const wt=()=>"9.1.0",Nt=e=>e.toString(16).padStart(2,"0"),Ct=e=>{const t=new Uint8Array(e/2);return window.crypto.getRandomValues(t),Array.from(t,Nt).join("")},Pt=()=>typeof window<"u"?Ct(10):new Date().getTime().toString(36);class G{}G.makeRequest=(e,t)=>({id:Pt(),method:e,params:t,env:{sdkVersion:wt()}});G.makeResponse=(e,t,n)=>({id:e,success:!0,version:n,data:t});G.makeErrorResponse=(e,t,n)=>({id:e,success:!1,error:t,version:n});var b;(function(e){e.sendTransactions="sendTransactions",e.rpcCall="rpcCall",e.getChainInfo="getChainInfo",e.getSafeInfo="getSafeInfo",e.getTxBySafeTxHash="getTxBySafeTxHash",e.getSafeBalances="getSafeBalances",e.signMessage="signMessage",e.signTypedMessage="signTypedMessage",e.getEnvironmentInfo="getEnvironmentInfo",e.getOffChainSignature="getOffChainSignature",e.requestAddressBook="requestAddressBook",e.wallet_getPermissions="wallet_getPermissions",e.wallet_requestPermissions="wallet_requestPermissions"})(b||(b={}));var X;(function(e){e.requestAddressBook="requestAddressBook"})(X||(X={}));class Dt{constructor(t=null,n=!1){this.allowedOrigins=null,this.callbacks=new Map,this.debugMode=!1,this.isServer=typeof window>"u",this.isValidMessage=({origin:i,data:r,source:s})=>{const o=!r,c=!this.isServer&&s===window.parent,l=typeof r.version<"u"&&parseInt(r.version.split(".")[0]),m=typeof l=="number"&&l>=1;let y=!0;return Array.isArray(this.allowedOrigins)&&(y=this.allowedOrigins.find(h=>h.test(i))!==void 0),!o&&c&&m&&y},this.logIncomingMessage=i=>{console.info(`Safe Apps SDK v1: A message was received from origin ${i.origin}. `,i.data)},this.onParentMessage=i=>{this.isValidMessage(i)&&(this.debugMode&&this.logIncomingMessage(i),this.handleIncomingMessage(i.data))},this.handleIncomingMessage=i=>{const{id:r}=i,s=this.callbacks.get(r);s&&(s(i),this.callbacks.delete(r))},this.send=(i,r)=>{const s=G.makeRequest(i,r);if(this.isServer)throw new Error("Window doesn't exist");return window.parent.postMessage(s,"*"),new Promise((o,c)=>{this.callbacks.set(s.id,l=>{if(!l.success){c(new Error(l.error));return}o(l)})})},this.allowedOrigins=t,this.debugMode=n,this.isServer||window.addEventListener("message",this.onParentMessage)}}const ue=e=>typeof e=="object"&&e!=null&&"domain"in e&&"types"in e&&"message"in e;var Mt={},A={},T={},Z=D&&D.__awaiter||function(e,t,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function c(y){try{m(i.next(y))}catch(h){o(h)}}function l(y){try{m(i.throw(y))}catch(h){o(h)}}function m(y){y.done?s(y.value):r(y.value).then(c,l)}m((i=i.apply(e,t||[])).next())})};Object.defineProperty(T,"__esModule",{value:!0});T.getData=T.fetchData=T.stringifyQuery=T.insertParams=void 0;const Rt=e=>typeof e=="object"&&e!==null&&"code"in e&&"message"in e;function Bt(e,t,n){return e.replace(new RegExp(`\\{${t}\\}`,"g"),n)}function $t(e,t){return t?Object.keys(t).reduce((n,i)=>Bt(n,i,String(t[i])),e):e}T.insertParams=$t;function Lt(e){if(!e)return"";const t=new URLSearchParams;Object.keys(e).forEach(i=>{e[i]!=null&&t.append(i,String(e[i]))});const n=t.toString();return n?`?${n}`:""}T.stringifyQuery=Lt;function de(e){return Z(this,void 0,void 0,function*(){let t;try{t=e.status===204?{}:yield e.json()}catch{if(e.headers&&e.headers.get("content-length")!=="0")throw new Error(`Invalid response content: ${e.statusText}`)}if(!e.ok){const n=Rt(t)?`${t.code}: ${t.message}`:e.statusText;throw new Error(n)}return t})}function jt(e,t,n,i,r){return Z(this,void 0,void 0,function*(){const s=Object.assign({"Content-Type":"application/json"},i),o={method:t??"POST",headers:s};r&&(o.credentials=r),n!=null&&(o.body=typeof n=="string"?n:JSON.stringify(n));const c=yield fetch(e,o);return de(c)})}T.fetchData=jt;function Ht(e,t,n){return Z(this,void 0,void 0,function*(){const i={method:"GET"};t&&(i.headers=Object.assign(Object.assign({},t),{"Content-Type":"application/json"})),n&&(i.credentials=n);const r=yield fetch(e,i);return de(r)})}T.getData=Ht;Object.defineProperty(A,"__esModule",{value:!0});A.getEndpoint=A.deleteEndpoint=A.putEndpoint=A.postEndpoint=void 0;const P=T;function V(e,t,n,i){const r=(0,P.insertParams)(t,n),s=(0,P.stringifyQuery)(i);return`${e}${r}${s}`}function zt(e,t,n){const i=V(e,t,n==null?void 0:n.path,n==null?void 0:n.query);return(0,P.fetchData)(i,"POST",n==null?void 0:n.body,n==null?void 0:n.headers,n==null?void 0:n.credentials)}A.postEndpoint=zt;function Ut(e,t,n){const i=V(e,t,n==null?void 0:n.path,n==null?void 0:n.query);return(0,P.fetchData)(i,"PUT",n==null?void 0:n.body,n==null?void 0:n.headers,n==null?void 0:n.credentials)}A.putEndpoint=Ut;function Gt(e,t,n){const i=V(e,t,n==null?void 0:n.path,n==null?void 0:n.query);return(0,P.fetchData)(i,"DELETE",n==null?void 0:n.body,n==null?void 0:n.headers,n==null?void 0:n.credentials)}A.deleteEndpoint=Gt;function Vt(e,t,n,i){if(i)return(0,P.getData)(i,void 0,n==null?void 0:n.credentials);const r=V(e,t,n==null?void 0:n.path,n==null?void 0:n.query);return(0,P.getData)(r,n==null?void 0:n.headers,n==null?void 0:n.credentials)}A.getEndpoint=Vt;var F={};Object.defineProperty(F,"__esModule",{value:!0});F.DEFAULT_BASE_URL=void 0;F.DEFAULT_BASE_URL="https://safe-client.safe.global";var fe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ImplementationVersionState=void 0,function(t){t.UP_TO_DATE="UP_TO_DATE",t.OUTDATED="OUTDATED",t.UNKNOWN="UNKNOWN"}(e.ImplementationVersionState||(e.ImplementationVersionState={}))})(fe);var le={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SafeAppSocialPlatforms=e.SafeAppFeatures=e.SafeAppAccessPolicyTypes=void 0,function(t){t.NoRestrictions="NO_RESTRICTIONS",t.DomainAllowlist="DOMAIN_ALLOWLIST"}(e.SafeAppAccessPolicyTypes||(e.SafeAppAccessPolicyTypes={})),function(t){t.BATCHED_TRANSACTIONS="BATCHED_TRANSACTIONS"}(e.SafeAppFeatures||(e.SafeAppFeatures={})),function(t){t.TWITTER="TWITTER",t.GITHUB="GITHUB",t.DISCORD="DISCORD"}(e.SafeAppSocialPlatforms||(e.SafeAppSocialPlatforms={}))})(le);var he={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LabelValue=e.StartTimeValue=e.DurationType=e.DetailedExecutionInfoType=e.TransactionListItemType=e.ConflictType=e.TransactionInfoType=e.SettingsInfoType=e.TransactionTokenType=e.TransferDirection=e.TransactionStatus=e.Operation=void 0,function(t){t[t.CALL=0]="CALL",t[t.DELEGATE=1]="DELEGATE"}(e.Operation||(e.Operation={})),function(t){t.AWAITING_CONFIRMATIONS="AWAITING_CONFIRMATIONS",t.AWAITING_EXECUTION="AWAITING_EXECUTION",t.CANCELLED="CANCELLED",t.FAILED="FAILED",t.SUCCESS="SUCCESS"}(e.TransactionStatus||(e.TransactionStatus={})),function(t){t.INCOMING="INCOMING",t.OUTGOING="OUTGOING",t.UNKNOWN="UNKNOWN"}(e.TransferDirection||(e.TransferDirection={})),function(t){t.ERC20="ERC20",t.ERC721="ERC721",t.NATIVE_COIN="NATIVE_COIN"}(e.TransactionTokenType||(e.TransactionTokenType={})),function(t){t.SET_FALLBACK_HANDLER="SET_FALLBACK_HANDLER",t.ADD_OWNER="ADD_OWNER",t.REMOVE_OWNER="REMOVE_OWNER",t.SWAP_OWNER="SWAP_OWNER",t.CHANGE_THRESHOLD="CHANGE_THRESHOLD",t.CHANGE_IMPLEMENTATION="CHANGE_IMPLEMENTATION",t.ENABLE_MODULE="ENABLE_MODULE",t.DISABLE_MODULE="DISABLE_MODULE",t.SET_GUARD="SET_GUARD",t.DELETE_GUARD="DELETE_GUARD"}(e.SettingsInfoType||(e.SettingsInfoType={})),function(t){t.TRANSFER="Transfer",t.SETTINGS_CHANGE="SettingsChange",t.CUSTOM="Custom",t.CREATION="Creation",t.SWAP_ORDER="SwapOrder",t.TWAP_ORDER="TwapOrder",t.SWAP_TRANSFER="SwapTransfer"}(e.TransactionInfoType||(e.TransactionInfoType={})),function(t){t.NONE="None",t.HAS_NEXT="HasNext",t.END="End"}(e.ConflictType||(e.ConflictType={})),function(t){t.TRANSACTION="TRANSACTION",t.LABEL="LABEL",t.CONFLICT_HEADER="CONFLICT_HEADER",t.DATE_LABEL="DATE_LABEL"}(e.TransactionListItemType||(e.TransactionListItemType={})),function(t){t.MULTISIG="MULTISIG",t.MODULE="MODULE"}(e.DetailedExecutionInfoType||(e.DetailedExecutionInfoType={})),function(t){t.AUTO="AUTO",t.LIMIT_DURATION="LIMIT_DURATION"}(e.DurationType||(e.DurationType={})),function(t){t.AT_MINING_TIME="AT_MINING_TIME",t.AT_EPOCH="AT_EPOCH"}(e.StartTimeValue||(e.StartTimeValue={})),function(t){t.Queued="Queued",t.Next="Next"}(e.LabelValue||(e.LabelValue={}))})(he);var ge={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.FEATURES=e.GAS_PRICE_TYPE=e.RPC_AUTHENTICATION=void 0,function(t){t.API_KEY_PATH="API_KEY_PATH",t.NO_AUTHENTICATION="NO_AUTHENTICATION",t.UNKNOWN="UNKNOWN"}(e.RPC_AUTHENTICATION||(e.RPC_AUTHENTICATION={})),function(t){t.ORACLE="ORACLE",t.FIXED="FIXED",t.FIXED_1559="FIXED1559",t.UNKNOWN="UNKNOWN"}(e.GAS_PRICE_TYPE||(e.GAS_PRICE_TYPE={})),function(t){t.ERC721="ERC721",t.SAFE_APPS="SAFE_APPS",t.CONTRACT_INTERACTION="CONTRACT_INTERACTION",t.DOMAIN_LOOKUP="DOMAIN_LOOKUP",t.SPENDING_LIMIT="SPENDING_LIMIT",t.EIP1559="EIP1559",t.SAFE_TX_GAS_OPTIONAL="SAFE_TX_GAS_OPTIONAL",t.TX_SIMULATION="TX_SIMULATION",t.EIP1271="EIP1271"}(e.FEATURES||(e.FEATURES={}))})(ge);var ye={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TokenType=void 0,function(t){t.ERC20="ERC20",t.ERC721="ERC721",t.NATIVE_TOKEN="NATIVE_TOKEN"}(e.TokenType||(e.TokenType={}))})(ye);var me={};Object.defineProperty(me,"__esModule",{value:!0});var be={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConfirmationViewTypes=void 0,function(t){t.COW_SWAP_ORDER="COW_SWAP_ORDER",t.COW_SWAP_TWAP_ORDER="COW_SWAP_TWAP_ORDER"}(e.ConfirmationViewTypes||(e.ConfirmationViewTypes={}))})(be);var Ee={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SafeMessageStatus=e.SafeMessageListItemType=void 0,function(t){t.DATE_LABEL="DATE_LABEL",t.MESSAGE="MESSAGE"}(e.SafeMessageListItemType||(e.SafeMessageListItemType={})),function(t){t.NEEDS_CONFIRMATION="NEEDS_CONFIRMATION",t.CONFIRMED="CONFIRMED"}(e.SafeMessageStatus||(e.SafeMessageStatus={}))})(Ee);var pe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DeviceType=void 0,function(t){t.ANDROID="ANDROID",t.IOS="IOS",t.WEB="WEB"}(e.DeviceType||(e.DeviceType={}))})(pe);var Ae={};Object.defineProperty(Ae,"__esModule",{value:!0});(function(e){var t=D&&D.__createBinding||(Object.create?function(a,u,d,f){f===void 0&&(f=d);var S=Object.getOwnPropertyDescriptor(u,d);(!S||("get"in S?!u.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(a,f,S)}:function(a,u,d,f){f===void 0&&(f=d),a[f]=u[d]}),n=D&&D.__exportStar||function(a,u){for(var d in a)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,a,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.verifyAuth=e.getAuthNonce=e.getContract=e.getSafeOverviews=e.unsubscribeAll=e.unsubscribeSingle=e.registerRecoveryModule=e.deleteRegisteredEmail=e.getRegisteredEmail=e.verifyEmail=e.resendEmailVerificationCode=e.changeEmail=e.registerEmail=e.unregisterDevice=e.unregisterSafe=e.registerDevice=e.getDelegates=e.confirmSafeMessage=e.proposeSafeMessage=e.getSafeMessage=e.getSafeMessages=e.getDecodedData=e.getMasterCopies=e.getSafeApps=e.getChainConfig=e.getChainsConfig=e.getConfirmationView=e.proposeTransaction=e.getNonces=e.postSafeGasEstimation=e.deleteTransaction=e.getTransactionDetails=e.getTransactionQueue=e.getTransactionHistory=e.getCollectiblesPage=e.getCollectibles=e.getAllOwnedSafes=e.getOwnedSafes=e.getFiatCurrencies=e.getBalances=e.getMultisigTransactions=e.getModuleTransactions=e.getIncomingTransfers=e.getSafeInfo=e.getRelayCount=e.relayTransaction=e.setBaseUrl=void 0;const i=A,r=F;n(fe,e),n(le,e),n(he,e),n(ge,e),n(ye,e),n(me,e),n(be,e),n(Ee,e),n(pe,e),n(Ae,e);let s=r.DEFAULT_BASE_URL;const o=a=>{s=a};e.setBaseUrl=o;function c(a,u){return(0,i.postEndpoint)(s,"/v1/chains/{chainId}/relay",{path:{chainId:a},body:u})}e.relayTransaction=c;function l(a,u){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/relay/{address}",{path:{chainId:a,address:u}})}e.getRelayCount=l;function m(a,u){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/safes/{address}",{path:{chainId:a,address:u}})}e.getSafeInfo=m;function y(a,u,d,f){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/safes/{address}/incoming-transfers/",{path:{chainId:a,address:u},query:d},f)}e.getIncomingTransfers=y;function h(a,u,d,f){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/safes/{address}/module-transactions/",{path:{chainId:a,address:u},query:d},f)}e.getModuleTransactions=h;function j(a,u,d,f){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/safes/{address}/multisig-transactions/",{path:{chainId:a,address:u},query:d},f)}e.getMultisigTransactions=j;function H(a,u,d="usd",f={}){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/safes/{address}/balances/{currency}",{path:{chainId:a,address:u,currency:d},query:f})}e.getBalances=H;function z(){return(0,i.getEndpoint)(s,"/v1/balances/supported-fiat-codes")}e.getFiatCurrencies=z;function W(a,u){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/owners/{address}/safes",{path:{chainId:a,address:u}})}e.getOwnedSafes=W;function C(a){return(0,i.getEndpoint)(s,"/v1/owners/{address}/safes",{path:{address:a}})}e.getAllOwnedSafes=C;function k(a,u,d={}){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/safes/{address}/collectibles",{path:{chainId:a,address:u},query:d})}e.getCollectibles=k;function We(a,u,d={},f){return(0,i.getEndpoint)(s,"/v2/chains/{chainId}/safes/{address}/collectibles",{path:{chainId:a,address:u},query:d},f)}e.getCollectiblesPage=We;function ke(a,u,d={},f){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/transactions/history",{path:{chainId:a,safe_address:u},query:d},f)}e.getTransactionHistory=ke;function qe(a,u,d={},f){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/transactions/queued",{path:{chainId:a,safe_address:u},query:d},f)}e.getTransactionQueue=qe;function Ke(a,u){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/transactions/{transactionId}",{path:{chainId:a,transactionId:u}})}e.getTransactionDetails=Ke;function Xe(a,u,d){return(0,i.deleteEndpoint)(s,"/v1/chains/{chainId}/transactions/{safeTxHash}",{path:{chainId:a,safeTxHash:u},body:{signature:d}})}e.deleteTransaction=Xe;function Qe(a,u,d){return(0,i.postEndpoint)(s,"/v2/chains/{chainId}/safes/{safe_address}/multisig-transactions/estimations",{path:{chainId:a,safe_address:u},body:d})}e.postSafeGasEstimation=Qe;function Ye(a,u){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/nonces",{path:{chainId:a,safe_address:u}})}e.getNonces=Ye;function Je(a,u,d){return(0,i.postEndpoint)(s,"/v1/chains/{chainId}/transactions/{safe_address}/propose",{path:{chainId:a,safe_address:u},body:d})}e.proposeTransaction=Je;function Ze(a,u,d,f){return(0,i.postEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/views/transaction-confirmation",{path:{chainId:a,safe_address:u},body:{data:d,to:f}})}e.getConfirmationView=Ze;function xe(a){return(0,i.getEndpoint)(s,"/v1/chains",{query:a})}e.getChainsConfig=xe;function et(a){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}",{path:{chainId:a}})}e.getChainConfig=et;function tt(a,u={}){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/safe-apps",{path:{chainId:a},query:u})}e.getSafeApps=tt;function nt(a){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/about/master-copies",{path:{chainId:a}})}e.getMasterCopies=nt;function it(a,u,d){return(0,i.postEndpoint)(s,"/v1/chains/{chainId}/data-decoder",{path:{chainId:a},body:{data:u,to:d}})}e.getDecodedData=it;function st(a,u,d){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/messages",{path:{chainId:a,safe_address:u},query:{}},d)}e.getSafeMessages=st;function rt(a,u){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/messages/{message_hash}",{path:{chainId:a,message_hash:u}})}e.getSafeMessage=rt;function at(a,u,d){return(0,i.postEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/messages",{path:{chainId:a,safe_address:u},body:d})}e.proposeSafeMessage=at;function ot(a,u,d){return(0,i.postEndpoint)(s,"/v1/chains/{chainId}/messages/{message_hash}/signatures",{path:{chainId:a,message_hash:u},body:d})}e.confirmSafeMessage=ot;function ct(a,u={}){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/delegates",{path:{chainId:a},query:u})}e.getDelegates=ct;function ut(a){return(0,i.postEndpoint)(s,"/v1/register/notifications",{body:a})}e.registerDevice=ut;function dt(a,u,d){return(0,i.deleteEndpoint)(s,"/v1/chains/{chainId}/notifications/devices/{uuid}/safes/{safe_address}",{path:{chainId:a,safe_address:u,uuid:d}})}e.unregisterSafe=dt;function ft(a,u){return(0,i.deleteEndpoint)(s,"/v1/chains/{chainId}/notifications/devices/{uuid}",{path:{chainId:a,uuid:u}})}e.unregisterDevice=ft;function lt(a,u,d,f){return(0,i.postEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/emails",{path:{chainId:a,safe_address:u},body:d,headers:f})}e.registerEmail=lt;function ht(a,u,d,f,S){return(0,i.putEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}",{path:{chainId:a,safe_address:u,signer:d},body:f,headers:S})}e.changeEmail=ht;function gt(a,u,d){return(0,i.postEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}/verify-resend",{path:{chainId:a,safe_address:u,signer:d},body:""})}e.resendEmailVerificationCode=gt;function yt(a,u,d,f){return(0,i.putEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}/verify",{path:{chainId:a,safe_address:u,signer:d},body:f})}e.verifyEmail=yt;function mt(a,u,d,f){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}",{path:{chainId:a,safe_address:u,signer:d},headers:f})}e.getRegisteredEmail=mt;function bt(a,u,d,f){return(0,i.deleteEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}",{path:{chainId:a,safe_address:u,signer:d},headers:f})}e.deleteRegisteredEmail=bt;function Et(a,u,d){return(0,i.postEndpoint)(s,"/v1/chains/{chainId}/safes/{safe_address}/recovery",{path:{chainId:a,safe_address:u},body:d})}e.registerRecoveryModule=Et;function pt(a){return(0,i.deleteEndpoint)(s,"/v1/subscriptions",{query:a})}e.unsubscribeSingle=pt;function At(a){return(0,i.deleteEndpoint)(s,"/v1/subscriptions/all",{query:a})}e.unsubscribeAll=At;function Tt(a,u){return(0,i.getEndpoint)(s,"/v1/safes",{query:Object.assign(Object.assign({},u),{safes:a.join(",")})})}e.getSafeOverviews=Tt;function It(a,u){return(0,i.getEndpoint)(s,"/v1/chains/{chainId}/contracts/{contractAddress}",{path:{chainId:a,contractAddress:u}})}e.getContract=It;function _t(){return(0,i.getEndpoint)(s,"/v1/auth/nonce",{credentials:"include"})}e.getAuthNonce=_t;function vt(a){return(0,i.postEndpoint)(s,"/v1/auth/verify",{body:a,credentials:"include"})}e.verifyAuth=vt})(Mt);class Ft{constructor(t){this.communicator=t}async getBySafeTxHash(t){if(!t)throw new Error("Invalid safeTxHash");return(await this.communicator.send(b.getTxBySafeTxHash,{safeTxHash:t})).data}async signMessage(t){const n={message:t};return(await this.communicator.send(b.signMessage,n)).data}async signTypedMessage(t){if(!ue(t))throw new Error("Invalid typed data");return(await this.communicator.send(b.signTypedMessage,{typedData:t})).data}async send({txs:t,params:n}){if(!t||!t.length)throw new Error("No transactions were passed");const i={txs:t,params:n};return(await this.communicator.send(b.sendTransactions,i)).data}}const E={eth_call:"eth_call",eth_gasPrice:"eth_gasPrice",eth_getLogs:"eth_getLogs",eth_getBalance:"eth_getBalance",eth_getCode:"eth_getCode",eth_getBlockByHash:"eth_getBlockByHash",eth_getBlockByNumber:"eth_getBlockByNumber",eth_getStorageAt:"eth_getStorageAt",eth_getTransactionByHash:"eth_getTransactionByHash",eth_getTransactionReceipt:"eth_getTransactionReceipt",eth_getTransactionCount:"eth_getTransactionCount",eth_estimateGas:"eth_estimateGas",safe_setSettings:"safe_setSettings"},_={defaultBlockParam:(e="latest")=>e,returnFullTxObjectParam:(e=!1)=>e,blockNumberToHex:e=>Number.isInteger(e)?`0x${e.toString(16)}`:e};class Wt{constructor(t){this.communicator=t,this.call=this.buildRequest({call:E.eth_call,formatters:[null,_.defaultBlockParam]}),this.getBalance=this.buildRequest({call:E.eth_getBalance,formatters:[null,_.defaultBlockParam]}),this.getCode=this.buildRequest({call:E.eth_getCode,formatters:[null,_.defaultBlockParam]}),this.getStorageAt=this.buildRequest({call:E.eth_getStorageAt,formatters:[null,_.blockNumberToHex,_.defaultBlockParam]}),this.getPastLogs=this.buildRequest({call:E.eth_getLogs}),this.getBlockByHash=this.buildRequest({call:E.eth_getBlockByHash,formatters:[null,_.returnFullTxObjectParam]}),this.getBlockByNumber=this.buildRequest({call:E.eth_getBlockByNumber,formatters:[_.blockNumberToHex,_.returnFullTxObjectParam]}),this.getTransactionByHash=this.buildRequest({call:E.eth_getTransactionByHash}),this.getTransactionReceipt=this.buildRequest({call:E.eth_getTransactionReceipt}),this.getTransactionCount=this.buildRequest({call:E.eth_getTransactionCount,formatters:[null,_.defaultBlockParam]}),this.getGasPrice=this.buildRequest({call:E.eth_gasPrice}),this.getEstimateGas=n=>this.buildRequest({call:E.eth_estimateGas})([n]),this.setSafeSettings=this.buildRequest({call:E.safe_setSettings})}buildRequest(t){const{call:n,formatters:i}=t;return async r=>{i&&Array.isArray(r)&&i.forEach((c,l)=>{c&&(r[l]=c(r[l]))});const s={call:n,params:r||[]};return(await this.communicator.send(b.rpcCall,s)).data}}}function Q(e,{includeName:t=!1}={}){if(e.type!=="function"&&e.type!=="event"&&e.type!=="error")throw new tn(e.type);return`${e.name}(${Te(e.inputs,{includeName:t})})`}function Te(e,{includeName:t=!1}={}){return e?e.map(n=>kt(n,{includeName:t})).join(t?", ":","):""}function kt(e,{includeName:t}){return e.type.startsWith("tuple")?`(${Te(e.components,{includeName:t})})${e.type.slice(5)}`:e.type+(t&&e.name?` ${e.name}`:"")}function $(e,{strict:t=!0}={}){return!e||typeof e!="string"?!1:t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")}function p(e){return $(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}const qt="2.17.5",Kt=()=>`viem@${qt}`;class g extends Error{constructor(t,n={}){var s;super(),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ViemError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:Kt()});const i=n.cause instanceof g?n.cause.details:(s=n.cause)!=null&&s.message?n.cause.message:n.details,r=n.cause instanceof g&&n.cause.docsPath||n.docsPath;this.message=[t||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...r?[`Docs: ${n.docsBaseUrl??"https://viem.sh"}${r}${n.docsSlug?`#${n.docsSlug}`:""}`]:[],...i?[`Details: ${i}`]:[],`Version: ${this.version}`].join(`
`),n.cause&&(this.cause=n.cause),this.details=i,this.docsPath=r,this.metaMessages=n.metaMessages,this.shortMessage=t}walk(t){return Ie(this,t)}}function Ie(e,t){return t!=null&&t(e)?e:e&&typeof e=="object"&&"cause"in e?Ie(e.cause,t):t?null:e}class Xt extends g{constructor({expectedLength:t,givenLength:n,type:i}){super([`ABI encoding array length mismatch for type ${i}.`,`Expected length: ${t}`,`Given length: ${n}`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiEncodingArrayLengthMismatchError"})}}class Qt extends g{constructor({expectedSize:t,value:n}){super(`Size of bytes "${n}" (bytes${p(n)}) does not match expected size (bytes${t}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiEncodingBytesSizeMismatchError"})}}class Yt extends g{constructor({expectedLength:t,givenLength:n}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${t}`,`Given length (values): ${n}`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiEncodingLengthMismatchError"})}}class se extends g{constructor(t,{docsPath:n}={}){super([`Function ${t?`"${t}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiFunctionNotFoundError"})}}class Jt extends g{constructor(t,n){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${t.type}\` in \`${Q(t.abiItem)}\`, and`,`\`${n.type}\` in \`${Q(n.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiItemAmbiguityError"})}}class Zt extends g{constructor({expectedSize:t,givenSize:n}){super(`Expected bytes${t}, got bytes${n}.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BytesSizeMismatchError"})}}class xt extends g{constructor(t,{docsPath:n}){super([`Type "${t}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiEncodingType"})}}class en extends g{constructor(t){super([`Value "${t}" is not a valid array.`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidArrayError"})}}class tn extends g{constructor(t){super([`"${t}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidDefinitionTypeError"})}}class _e extends g{constructor({offset:t,position:n,size:i}){super(`Slice ${n==="start"?"starting":"ending"} at offset "${t}" is out-of-bounds (size: ${i}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SliceOffsetOutOfBoundsError"})}}class ve extends g{constructor({size:t,targetSize:n,type:i}){super(`${i.charAt(0).toUpperCase()}${i.slice(1).toLowerCase()} size (${t}) exceeds padding size (${n}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SizeExceedsPaddingSizeError"})}}function M(e,{dir:t,size:n=32}={}){return typeof e=="string"?O(e,{dir:t,size:n}):nn(e,{dir:t,size:n})}function O(e,{dir:t,size:n=32}={}){if(n===null)return e;const i=e.replace("0x","");if(i.length>n*2)throw new ve({size:Math.ceil(i.length/2),targetSize:n,type:"hex"});return`0x${i[t==="right"?"padEnd":"padStart"](n*2,"0")}`}function nn(e,{dir:t,size:n=32}={}){if(n===null)return e;if(e.length>n)throw new ve({size:e.length,targetSize:n,type:"bytes"});const i=new Uint8Array(n);for(let r=0;r<n;r++){const s=t==="right";i[s?r:n-r-1]=e[s?r:e.length-r-1]}return i}class sn extends g{constructor({max:t,min:n,signed:i,size:r,value:s}){super(`Number "${s}" is not in safe ${r?`${r*8}-bit ${i?"signed":"unsigned"} `:""}integer range ${t?`(${n} to ${t})`:`(above ${n})`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"IntegerOutOfRangeError"})}}class rn extends g{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${t} bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SizeOverflowError"})}}function L(e,{size:t}){if(p(e)>t)throw new rn({givenSize:p(e),maxSize:t})}const an=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function x(e,t={}){return typeof e=="number"||typeof e=="bigint"?N(e,t):typeof e=="string"?U(e,t):typeof e=="boolean"?Se(e,t):ee(e,t)}function Se(e,t={}){const n=`0x${Number(e)}`;return typeof t.size=="number"?(L(n,{size:t.size}),M(n,{size:t.size})):n}function ee(e,t={}){let n="";for(let r=0;r<e.length;r++)n+=an[e[r]];const i=`0x${n}`;return typeof t.size=="number"?(L(i,{size:t.size}),M(i,{dir:"right",size:t.size})):i}function N(e,t={}){const{signed:n,size:i}=t,r=BigInt(e);let s;i?n?s=(1n<<BigInt(i)*8n-1n)-1n:s=2n**(BigInt(i)*8n)-1n:typeof e=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&n?-s-1n:0;if(s&&r>s||r<o){const l=typeof e=="bigint"?"n":"";throw new sn({max:s?`${s}${l}`:void 0,min:`${o}${l}`,signed:n,size:i,value:`${e}${l}`})}const c=`0x${(n&&r<0?(1n<<BigInt(i*8))+BigInt(r):r).toString(16)}`;return i?M(c,{size:i}):c}const on=new TextEncoder;function U(e,t={}){const n=on.encode(e);return ee(n,t)}const cn=new TextEncoder;function Oe(e,t={}){return typeof e=="number"||typeof e=="bigint"?dn(e,t):typeof e=="boolean"?un(e,t):$(e)?we(e,t):Ne(e,t)}function un(e,t={}){const n=new Uint8Array(1);return n[0]=Number(e),typeof t.size=="number"?(L(n,{size:t.size}),M(n,{size:t.size})):n}const v={zero:48,nine:57,A:65,F:70,a:97,f:102};function re(e){if(e>=v.zero&&e<=v.nine)return e-v.zero;if(e>=v.A&&e<=v.F)return e-(v.A-10);if(e>=v.a&&e<=v.f)return e-(v.a-10)}function we(e,t={}){let n=e;t.size&&(L(n,{size:t.size}),n=M(n,{dir:"right",size:t.size}));let i=n.slice(2);i.length%2&&(i=`0${i}`);const r=i.length/2,s=new Uint8Array(r);for(let o=0,c=0;o<r;o++){const l=re(i.charCodeAt(c++)),m=re(i.charCodeAt(c++));if(l===void 0||m===void 0)throw new g(`Invalid byte sequence ("${i[c-2]}${i[c-1]}" in "${i}").`);s[o]=l*16+m}return s}function dn(e,t){const n=N(e,t);return we(n)}function Ne(e,t={}){const n=cn.encode(e);return typeof t.size=="number"?(L(n,{size:t.size}),M(n,{dir:"right",size:t.size})):n}function I(e,t){const n=t||"hex",i=St($(e,{strict:!1})?Oe(e):e);return n==="bytes"?i:x(i)}const fn=e=>I(Oe(e));function ln(e){return fn(e)}function hn(e){let t=!0,n="",i=0,r="",s=!1;for(let o=0;o<e.length;o++){const c=e[o];if(["(",")",","].includes(c)&&(t=!0),c==="("&&i++,c===")"&&i--,!!t){if(i===0){if(c===" "&&["event","function",""].includes(r))r="";else if(r+=c,c===")"){s=!0;break}continue}if(c===" "){e[o-1]!==","&&n!==","&&n!==",("&&(n="",t=!1);continue}r+=c,n+=c}}if(!s)throw new g("Unable to normalize signature.");return r}const gn=e=>{const t=typeof e=="string"?e:Ot(e);return hn(t)};function Ce(e){return ln(gn(e))}const yn=Ce;class Pe extends g{constructor({address:t}){super(`Address "${t}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAddressError"})}}class De extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}set(t,n){return super.set(t,n),this.maxSize&&this.size>this.maxSize&&this.delete(this.keys().next().value),this}}const q=new De(8192);function mn(e,t){if(q.has(`${e}.${t}`))return q.get(`${e}.${t}`);const n=e.substring(2).toLowerCase(),i=I(Ne(n),"bytes"),r=n.split("");for(let o=0;o<40;o+=2)i[o>>1]>>4>=8&&r[o]&&(r[o]=r[o].toUpperCase()),(i[o>>1]&15)>=8&&r[o+1]&&(r[o+1]=r[o+1].toUpperCase());const s=`0x${r.join("")}`;return q.set(`${e}.${t}`,s),s}const bn=/^0x[a-fA-F0-9]{40}$/,K=new De(8192);function R(e,t){const{strict:n=!0}=t??{},i=`${e}.${n}`;if(K.has(i))return K.get(i);const r=bn.test(e)?e.toLowerCase()===e?!0:n?mn(e)===e:!0:!1;return K.set(i,r),r}function w(e){return typeof e[0]=="string"?Me(e):En(e)}function En(e){let t=0;for(const r of e)t+=r.length;const n=new Uint8Array(t);let i=0;for(const r of e)n.set(r,i),i+=r.length;return n}function Me(e){return`0x${e.reduce((t,n)=>t+n.replace("0x",""),"")}`}function Re(e,t,n,{strict:i}={}){return $(e,{strict:!1})?An(e,t,n,{strict:i}):pn(e,t,n,{strict:i})}function Be(e,t){if(typeof t=="number"&&t>0&&t>p(e)-1)throw new _e({offset:t,position:"start",size:p(e)})}function $e(e,t,n){if(typeof t=="number"&&typeof n=="number"&&p(e)!==n-t)throw new _e({offset:n,position:"end",size:p(e)})}function pn(e,t,n,{strict:i}={}){Be(e,t);const r=e.slice(t,n);return i&&$e(r,t,n),r}function An(e,t,n,{strict:i}={}){Be(e,t);const r=`0x${e.replace("0x","").slice((t??0)*2,(n??e.length)*2)}`;return i&&$e(r,t,n),r}function te(e,t){if(e.length!==t.length)throw new Yt({expectedLength:e.length,givenLength:t.length});const n=Tn({params:e,values:t}),i=ie(n);return i.length===0?"0x":i}function Tn({params:e,values:t}){const n=[];for(let i=0;i<e.length;i++)n.push(ne({param:e[i],value:t[i]}));return n}function ne({param:e,value:t}){const n=Cn(e.type);if(n){const[i,r]=n;return _n(t,{length:i,param:{...e,type:r}})}if(e.type==="tuple")return Nn(t,{param:e});if(e.type==="address")return In(t);if(e.type==="bool")return Sn(t);if(e.type.startsWith("uint")||e.type.startsWith("int")){const i=e.type.startsWith("int");return On(t,{signed:i})}if(e.type.startsWith("bytes"))return vn(t,{param:e});if(e.type==="string")return wn(t);throw new xt(e.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function ie(e){let t=0;for(let s=0;s<e.length;s++){const{dynamic:o,encoded:c}=e[s];o?t+=32:t+=p(c)}const n=[],i=[];let r=0;for(let s=0;s<e.length;s++){const{dynamic:o,encoded:c}=e[s];o?(n.push(N(t+r,{size:32})),i.push(c),r+=p(c)):n.push(c)}return w([...n,...i])}function In(e){if(!R(e))throw new Pe({address:e});return{dynamic:!1,encoded:O(e.toLowerCase())}}function _n(e,{length:t,param:n}){const i=t===null;if(!Array.isArray(e))throw new en(e);if(!i&&e.length!==t)throw new Xt({expectedLength:t,givenLength:e.length,type:`${n.type}[${t}]`});let r=!1;const s=[];for(let o=0;o<e.length;o++){const c=ne({param:n,value:e[o]});c.dynamic&&(r=!0),s.push(c)}if(i||r){const o=ie(s);if(i){const c=N(s.length,{size:32});return{dynamic:!0,encoded:s.length>0?w([c,o]):c}}if(r)return{dynamic:!0,encoded:o}}return{dynamic:!1,encoded:w(s.map(({encoded:o})=>o))}}function vn(e,{param:t}){const[,n]=t.type.split("bytes"),i=p(e);if(!n){let r=e;return i%32!==0&&(r=O(r,{dir:"right",size:Math.ceil((e.length-2)/2/32)*32})),{dynamic:!0,encoded:w([O(N(i,{size:32})),r])}}if(i!==Number.parseInt(n))throw new Qt({expectedSize:Number.parseInt(n),value:e});return{dynamic:!1,encoded:O(e,{dir:"right"})}}function Sn(e){if(typeof e!="boolean")throw new g(`Invalid boolean value: "${e}" (type: ${typeof e}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:O(Se(e))}}function On(e,{signed:t}){return{dynamic:!1,encoded:N(e,{size:32,signed:t})}}function wn(e){const t=U(e),n=Math.ceil(p(t)/32),i=[];for(let r=0;r<n;r++)i.push(O(Re(t,r*32,(r+1)*32),{dir:"right"}));return{dynamic:!0,encoded:w([O(N(p(t),{size:32})),...i])}}function Nn(e,{param:t}){let n=!1;const i=[];for(let r=0;r<t.components.length;r++){const s=t.components[r],o=Array.isArray(e)?r:s.name,c=ne({param:s,value:e[o]});i.push(c),c.dynamic&&(n=!0)}return{dynamic:n,encoded:n?ie(i):w(i.map(({encoded:r})=>r))}}function Cn(e){const t=e.match(/^(.*)\[(\d+)?\]$/);return t?[t[2]?Number(t[2]):null,t[1]]:void 0}const Le=e=>Re(Ce(e),0,4);function Pn(e){const{abi:t,args:n=[],name:i}=e,r=$(i,{strict:!1}),s=t.filter(c=>r?c.type==="function"?Le(c)===i:c.type==="event"?yn(c)===i:!1:"name"in c&&c.name===i);if(s.length===0)return;if(s.length===1)return s[0];let o;for(const c of s){if(!("inputs"in c))continue;if(!n||n.length===0){if(!c.inputs||c.inputs.length===0)return c;continue}if(!c.inputs||c.inputs.length===0||c.inputs.length!==n.length)continue;if(n.every((m,y)=>{const h="inputs"in c&&c.inputs[y];return h?Y(m,h):!1})){if(o&&"inputs"in o&&o.inputs){const m=je(c.inputs,o.inputs,n);if(m)throw new Jt({abiItem:c,type:m[0]},{abiItem:o,type:m[1]})}o=c}}return o||s[0]}function Y(e,t){const n=typeof e,i=t.type;switch(i){case"address":return R(e,{strict:!1});case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return i==="tuple"&&"components"in t?Object.values(t.components).every((r,s)=>Y(Object.values(e)[s],r)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(i)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(i)?n==="string"||e instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(i)?Array.isArray(e)&&e.every(r=>Y(r,{...t,type:i.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function je(e,t,n){for(const i in e){const r=e[i],s=t[i];if(r.type==="tuple"&&s.type==="tuple"&&"components"in r&&"components"in s)return je(r.components,s.components,n[i]);const o=[r.type,s.type];if(o.includes("address")&&o.includes("bytes20")?!0:o.includes("address")&&o.includes("string")?R(n[i],{strict:!1}):o.includes("address")&&o.includes("bytes")?R(n[i],{strict:!1}):!1)return o}}const ae="/docs/contract/encodeFunctionData";function Dn(e){const{abi:t,args:n,functionName:i}=e;let r=t[0];if(i){const s=Pn({abi:t,args:n,name:i});if(!s)throw new se(i,{docsPath:ae});r=s}if(r.type!=="function")throw new se(void 0,{docsPath:ae});return{abi:[r],functionName:Le(Q(r))}}function oe(e){const{args:t}=e,{abi:n,functionName:i}=(()=>{var c;return e.abi.length===1&&((c=e.functionName)!=null&&c.startsWith("0x"))?e:Dn(e)})(),r=n[0],s=i,o="inputs"in r&&r.inputs?te(r.inputs,t??[]):void 0;return Me([s,o??"0x"])}const Mn=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,Rn=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function Bn(e){const{domain:t={},message:n,primaryType:i}=e,r={EIP712Domain:zn({domain:t}),...e.types};Hn({domain:t,message:n,primaryType:i,types:r});const s=["0x1901"];return t&&s.push($n({domain:t,types:r})),i!=="EIP712Domain"&&s.push(He({data:n,primaryType:i,types:r})),I(w(s))}function $n({domain:e,types:t}){return He({data:e,primaryType:"EIP712Domain",types:t})}function He({data:e,primaryType:t,types:n}){const i=ze({data:e,primaryType:t,types:n});return I(i)}function ze({data:e,primaryType:t,types:n}){const i=[{type:"bytes32"}],r=[Ln({primaryType:t,types:n})];for(const s of n[t]){const[o,c]=Ge({types:n,name:s.name,type:s.type,value:e[s.name]});i.push(o),r.push(c)}return te(i,r)}function Ln({primaryType:e,types:t}){const n=x(jn({primaryType:e,types:t}));return I(n)}function jn({primaryType:e,types:t}){let n="";const i=Ue({primaryType:e,types:t});i.delete(e);const r=[e,...Array.from(i).sort()];for(const s of r)n+=`${s}(${t[s].map(({name:o,type:c})=>`${c} ${o}`).join(",")})`;return n}function Ue({primaryType:e,types:t},n=new Set){const i=e.match(/^\w*/u),r=i==null?void 0:i[0];if(n.has(r)||t[r]===void 0)return n;n.add(r);for(const s of t[r])Ue({primaryType:s.type,types:t},n);return n}function Ge({types:e,name:t,type:n,value:i}){if(e[n]!==void 0)return[{type:"bytes32"},I(ze({data:i,primaryType:n,types:e}))];if(n==="bytes")return i=`0x${(i.length%2?"0":"")+i.slice(2)}`,[{type:"bytes32"},I(i)];if(n==="string")return[{type:"bytes32"},I(x(i))];if(n.lastIndexOf("]")===n.length-1){const r=n.slice(0,n.lastIndexOf("[")),s=i.map(o=>Ge({name:t,type:r,types:e,value:o}));return[{type:"bytes32"},I(te(s.map(([o])=>o),s.map(([,o])=>o)))]}return[{type:n},i]}function Hn(e){const{domain:t,message:n,primaryType:i,types:r}=e,s=(o,c)=>{for(const l of o){const{name:m,type:y}=l,h=c[m],j=y.match(Rn);if(j&&(typeof h=="number"||typeof h=="bigint")){const[W,C,k]=j;N(h,{signed:C==="int",size:Number.parseInt(k)/8})}if(y==="address"&&typeof h=="string"&&!R(h))throw new Pe({address:h});const H=y.match(Mn);if(H){const[W,C]=H;if(C&&p(h)!==Number.parseInt(C))throw new Zt({expectedSize:Number.parseInt(C),givenSize:p(h)})}const z=r[y];z&&s(z,h)}};r.EIP712Domain&&t&&s(r.EIP712Domain,t),i!=="EIP712Domain"&&s(r[i],n)}function zn({domain:e}){return[typeof(e==null?void 0:e.name)=="string"&&{name:"name",type:"string"},(e==null?void 0:e.version)&&{name:"version",type:"string"},typeof(e==null?void 0:e.chainId)=="number"&&{name:"chainId",type:"uint256"},(e==null?void 0:e.verifyingContract)&&{name:"verifyingContract",type:"address"},(e==null?void 0:e.salt)&&{name:"salt",type:"bytes32"}].filter(Boolean)}const Un=`Ethereum Signed Message:
`;function Gn(e){const t=typeof e=="string"?U(e):typeof e.raw=="string"?e.raw:ee(e.raw),n=U(`${Un}${p(t)}`);return w([n,t])}function Vn(e,t){return I(Gn(e),t)}const Fn="0x1626ba7e",Wn="0x20c13b0b",J=4001;class B extends Error{constructor(t,n,i){super(t),this.code=n,this.data=i,Object.setPrototypeOf(this,B.prototype)}}class Ve{constructor(t){this.communicator=t}async getPermissions(){return(await this.communicator.send(b.wallet_getPermissions,void 0)).data}async requestPermissions(t){if(!this.isPermissionRequestValid(t))throw new B("Permissions request is invalid",J);try{return(await this.communicator.send(b.wallet_requestPermissions,t)).data}catch{throw new B("Permissions rejected",J)}}isPermissionRequestValid(t){return t.every(n=>typeof n=="object"?Object.keys(n).every(i=>!!Object.values(X).includes(i)):!1)}}const ce=(e,t)=>t.some(n=>n.parentCapability===e),kn=()=>(e,t,n)=>{const i=n.value;return n.value=async function(){const r=new Ve(this.communicator);let s=await r.getPermissions();if(ce(t,s)||(s=await r.requestPermissions([{[t]:{}}])),!ce(t,s))throw new B("Permissions rejected",J);return i.apply(this)},n};var qn=function(e,t,n,i){var r=arguments.length,s=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s};class Fe{constructor(t){this.communicator=t}async getChainInfo(){return(await this.communicator.send(b.getChainInfo,void 0)).data}async getInfo(){return(await this.communicator.send(b.getSafeInfo,void 0)).data}async experimental_getBalances({currency:t="usd"}={}){return(await this.communicator.send(b.getSafeBalances,{currency:t})).data}async check1271Signature(t,n="0x"){const i=await this.getInfo(),r=oe({abi:[{constant:!1,inputs:[{name:"_dataHash",type:"bytes32"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[t,n]}),s={call:E.eth_call,params:[{to:i.safeAddress,data:r},"latest"]};try{return(await this.communicator.send(b.rpcCall,s)).data.slice(0,10).toLowerCase()===Fn}catch{return!1}}async check1271SignatureBytes(t,n="0x"){const i=await this.getInfo(),r=oe({abi:[{constant:!1,inputs:[{name:"_data",type:"bytes"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[t,n]}),s={call:E.eth_call,params:[{to:i.safeAddress,data:r},"latest"]};try{return(await this.communicator.send(b.rpcCall,s)).data.slice(0,10).toLowerCase()===Wn}catch{return!1}}calculateMessageHash(t){return Vn(t)}calculateTypedMessageHash(t){const n=typeof t.domain.chainId=="object"?t.domain.chainId.toNumber():Number(t.domain.chainId);let i=t.primaryType;if(!i){const r=Object.values(t.types),s=Object.keys(t.types).filter(o=>r.every(c=>c.every(({type:l})=>l.replace("[","").replace("]","")!==o)));if(s.length===0||s.length>1)throw new Error("Please specify primaryType");i=s[0]}return Bn({message:t.message,domain:{...t.domain,chainId:n,verifyingContract:t.domain.verifyingContract,salt:t.domain.salt},types:t.types,primaryType:i})}async getOffChainSignature(t){return(await this.communicator.send(b.getOffChainSignature,t)).data}async isMessageSigned(t,n="0x"){let i;if(typeof t=="string"&&(i=async()=>{const r=this.calculateMessageHash(t);return await this.isMessageHashSigned(r,n)}),ue(t)&&(i=async()=>{const r=this.calculateTypedMessageHash(t);return await this.isMessageHashSigned(r,n)}),i)return await i();throw new Error("Invalid message type")}async isMessageHashSigned(t,n="0x"){const i=[this.check1271Signature.bind(this),this.check1271SignatureBytes.bind(this)];for(const r of i)if(await r(t,n))return!0;return!1}async getEnvironmentInfo(){return(await this.communicator.send(b.getEnvironmentInfo,void 0)).data}async requestAddressBook(){return(await this.communicator.send(b.requestAddressBook,void 0)).data}}qn([kn()],Fe.prototype,"requestAddressBook",null);class Kn{constructor(t={}){const{allowedDomains:n=null,debug:i=!1}=t;this.communicator=new Dt(n,i),this.eth=new Wt(this.communicator),this.txs=new Ft(this.communicator),this.safe=new Fe(this.communicator),this.wallet=new Ve(this.communicator)}}const Qn=Kn;export{G as MessageFormatter,b as Methods,E as RPC_CALLS,X as RestrictedMethods,Qn as default,wt as getSDKVersion,ue as isObjectEIP712TypedData};
