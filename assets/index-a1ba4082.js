import{b as sr,i as or,a as hr,g as ar,d as fr,c as Pe,s as ur,r as $e,e as Ue,f as cr,m as Fe}from"./index-15a7afaf.js";import{ay as lr,az as dr,aA as De,aB as pr,aC as mr,aD as gr,aE as yr,aF as wr,aG as Oe,aH as jt}from"./vendor-34f3062c.js";const vr=["session_request","session_update","exchange_key","connect","disconnect","display_uri","modal_closed","transport_open","transport_close","transport_error"],He=["eth_sendTransaction","eth_signTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v2","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","wallet_addEthereumChain","wallet_switchEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"];var Me={exports:{}};Me.exports;(function(u){(function(s,p){function w(g,t){if(!g)throw new Error(t||"Assertion failed")}function b(g,t){g.super_=t;var n=function(){};n.prototype=t.prototype,g.prototype=new n,g.prototype.constructor=g}function m(g,t,n){if(m.isBN(g))return g;this.negative=0,this.words=null,this.length=0,this.red=null,g!==null&&((t==="le"||t==="be")&&(n=t,t=10),this._init(g||0,t||10,n||"be"))}typeof s=="object"?s.exports=m:p.BN=m,m.BN=m,m.wordSize=26;var P;try{P=lr.Buffer}catch{}m.isBN=function(t){return t instanceof m?!0:t!==null&&typeof t=="object"&&t.constructor.wordSize===m.wordSize&&Array.isArray(t.words)},m.max=function(t,n){return t.cmp(n)>0?t:n},m.min=function(t,n){return t.cmp(n)<0?t:n},m.prototype._init=function(t,n,h){if(typeof t=="number")return this._initNumber(t,n,h);if(typeof t=="object")return this._initArray(t,n,h);n==="hex"&&(n=16),w(n===(n|0)&&n>=2&&n<=36),t=t.toString().replace(/\s+/g,"");var f=0;t[0]==="-"&&f++,n===16?this._parseHex(t,f):this._parseBase(t,n,f),t[0]==="-"&&(this.negative=1),this.strip(),h==="le"&&this._initArray(this.toArray(),n,h)},m.prototype._initNumber=function(t,n,h){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[t&67108863],this.length=1):t<4503599627370496?(this.words=[t&67108863,t/67108864&67108863],this.length=2):(w(t<9007199254740992),this.words=[t&67108863,t/67108864&67108863,1],this.length=3),h==="le"&&this._initArray(this.toArray(),n,h)},m.prototype._initArray=function(t,n,h){if(w(typeof t.length=="number"),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var f=0;f<this.length;f++)this.words[f]=0;var d,y,_=0;if(h==="be")for(f=t.length-1,d=0;f>=0;f-=3)y=t[f]|t[f-1]<<8|t[f-2]<<16,this.words[d]|=y<<_&67108863,this.words[d+1]=y>>>26-_&67108863,_+=24,_>=26&&(_-=26,d++);else if(h==="le")for(f=0,d=0;f<t.length;f+=3)y=t[f]|t[f+1]<<8|t[f+2]<<16,this.words[d]|=y<<_&67108863,this.words[d+1]=y>>>26-_&67108863,_+=24,_>=26&&(_-=26,d++);return this.strip()};function x(g,t,n){for(var h=0,f=Math.min(g.length,n),d=t;d<f;d++){var y=g.charCodeAt(d)-48;h<<=4,y>=49&&y<=54?h|=y-49+10:y>=17&&y<=22?h|=y-17+10:h|=y&15}return h}m.prototype._parseHex=function(t,n){this.length=Math.ceil((t.length-n)/6),this.words=new Array(this.length);for(var h=0;h<this.length;h++)this.words[h]=0;var f,d,y=0;for(h=t.length-6,f=0;h>=n;h-=6)d=x(t,h,h+6),this.words[f]|=d<<y&67108863,this.words[f+1]|=d>>>26-y&4194303,y+=24,y>=26&&(y-=26,f++);h+6!==n&&(d=x(t,n,h+6),this.words[f]|=d<<y&67108863,this.words[f+1]|=d>>>26-y&4194303),this.strip()};function $(g,t,n,h){for(var f=0,d=Math.min(g.length,n),y=t;y<d;y++){var _=g.charCodeAt(y)-48;f*=h,_>=49?f+=_-49+10:_>=17?f+=_-17+10:f+=_}return f}m.prototype._parseBase=function(t,n,h){this.words=[0],this.length=1;for(var f=0,d=1;d<=67108863;d*=n)f++;f--,d=d/n|0;for(var y=t.length-h,_=y%f,c=Math.min(y,y-_)+h,i=0,l=h;l<c;l+=f)i=$(t,l,l+f,n),this.imuln(d),this.words[0]+i<67108864?this.words[0]+=i:this._iaddn(i);if(_!==0){var R=1;for(i=$(t,l,t.length,n),l=0;l<_;l++)R*=n;this.imuln(R),this.words[0]+i<67108864?this.words[0]+=i:this._iaddn(i)}},m.prototype.copy=function(t){t.words=new Array(this.length);for(var n=0;n<this.length;n++)t.words[n]=this.words[n];t.length=this.length,t.negative=this.negative,t.red=this.red},m.prototype.clone=function(){var t=new m(null);return this.copy(t),t},m.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},m.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},m.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},m.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var Mt=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],Bt=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],It=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];m.prototype.toString=function(t,n){t=t||10,n=n|0||1;var h;if(t===16||t==="hex"){h="";for(var f=0,d=0,y=0;y<this.length;y++){var _=this.words[y],c=((_<<f|d)&16777215).toString(16);d=_>>>24-f&16777215,d!==0||y!==this.length-1?h=Mt[6-c.length]+c+h:h=c+h,f+=2,f>=26&&(f-=26,y--)}for(d!==0&&(h=d.toString(16)+h);h.length%n!==0;)h="0"+h;return this.negative!==0&&(h="-"+h),h}if(t===(t|0)&&t>=2&&t<=36){var i=Bt[t],l=It[t];h="";var R=this.clone();for(R.negative=0;!R.isZero();){var k=R.modn(l).toString(t);R=R.idivn(l),R.isZero()?h=k+h:h=Mt[i-k.length]+k+h}for(this.isZero()&&(h="0"+h);h.length%n!==0;)h="0"+h;return this.negative!==0&&(h="-"+h),h}w(!1,"Base should be between 2 and 36")},m.prototype.toNumber=function(){var t=this.words[0];return this.length===2?t+=this.words[1]*67108864:this.length===3&&this.words[2]===1?t+=4503599627370496+this.words[1]*67108864:this.length>2&&w(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-t:t},m.prototype.toJSON=function(){return this.toString(16)},m.prototype.toBuffer=function(t,n){return w(typeof P<"u"),this.toArrayLike(P,t,n)},m.prototype.toArray=function(t,n){return this.toArrayLike(Array,t,n)},m.prototype.toArrayLike=function(t,n,h){var f=this.byteLength(),d=h||Math.max(1,f);w(f<=d,"byte array longer than desired length"),w(d>0,"Requested array length <= 0"),this.strip();var y=n==="le",_=new t(d),c,i,l=this.clone();if(y){for(i=0;!l.isZero();i++)c=l.andln(255),l.iushrn(8),_[i]=c;for(;i<d;i++)_[i]=0}else{for(i=0;i<d-f;i++)_[i]=0;for(i=0;!l.isZero();i++)c=l.andln(255),l.iushrn(8),_[d-i-1]=c}return _},Math.clz32?m.prototype._countBits=function(t){return 32-Math.clz32(t)}:m.prototype._countBits=function(t){var n=t,h=0;return n>=4096&&(h+=13,n>>>=13),n>=64&&(h+=7,n>>>=7),n>=8&&(h+=4,n>>>=4),n>=2&&(h+=2,n>>>=2),h+n},m.prototype._zeroBits=function(t){if(t===0)return 26;var n=t,h=0;return n&8191||(h+=13,n>>>=13),n&127||(h+=7,n>>>=7),n&15||(h+=4,n>>>=4),n&3||(h+=2,n>>>=2),n&1||h++,h},m.prototype.bitLength=function(){var t=this.words[this.length-1],n=this._countBits(t);return(this.length-1)*26+n};function Et(g){for(var t=new Array(g.bitLength()),n=0;n<t.length;n++){var h=n/26|0,f=n%26;t[n]=(g.words[h]&1<<f)>>>f}return t}m.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,n=0;n<this.length;n++){var h=this._zeroBits(this.words[n]);if(t+=h,h!==26)break}return t},m.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},m.prototype.toTwos=function(t){return this.negative!==0?this.abs().inotn(t).iaddn(1):this.clone()},m.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},m.prototype.isNeg=function(){return this.negative!==0},m.prototype.neg=function(){return this.clone().ineg()},m.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},m.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var n=0;n<t.length;n++)this.words[n]=this.words[n]|t.words[n];return this.strip()},m.prototype.ior=function(t){return w((this.negative|t.negative)===0),this.iuor(t)},m.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},m.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},m.prototype.iuand=function(t){var n;this.length>t.length?n=t:n=this;for(var h=0;h<n.length;h++)this.words[h]=this.words[h]&t.words[h];return this.length=n.length,this.strip()},m.prototype.iand=function(t){return w((this.negative|t.negative)===0),this.iuand(t)},m.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},m.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},m.prototype.iuxor=function(t){var n,h;this.length>t.length?(n=this,h=t):(n=t,h=this);for(var f=0;f<h.length;f++)this.words[f]=n.words[f]^h.words[f];if(this!==n)for(;f<n.length;f++)this.words[f]=n.words[f];return this.length=n.length,this.strip()},m.prototype.ixor=function(t){return w((this.negative|t.negative)===0),this.iuxor(t)},m.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},m.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},m.prototype.inotn=function(t){w(typeof t=="number"&&t>=0);var n=Math.ceil(t/26)|0,h=t%26;this._expand(n),h>0&&n--;for(var f=0;f<n;f++)this.words[f]=~this.words[f]&67108863;return h>0&&(this.words[f]=~this.words[f]&67108863>>26-h),this.strip()},m.prototype.notn=function(t){return this.clone().inotn(t)},m.prototype.setn=function(t,n){w(typeof t=="number"&&t>=0);var h=t/26|0,f=t%26;return this._expand(h+1),n?this.words[h]=this.words[h]|1<<f:this.words[h]=this.words[h]&~(1<<f),this.strip()},m.prototype.iadd=function(t){var n;if(this.negative!==0&&t.negative===0)return this.negative=0,n=this.isub(t),this.negative^=1,this._normSign();if(this.negative===0&&t.negative!==0)return t.negative=0,n=this.isub(t),t.negative=1,n._normSign();var h,f;this.length>t.length?(h=this,f=t):(h=t,f=this);for(var d=0,y=0;y<f.length;y++)n=(h.words[y]|0)+(f.words[y]|0)+d,this.words[y]=n&67108863,d=n>>>26;for(;d!==0&&y<h.length;y++)n=(h.words[y]|0)+d,this.words[y]=n&67108863,d=n>>>26;if(this.length=h.length,d!==0)this.words[this.length]=d,this.length++;else if(h!==this)for(;y<h.length;y++)this.words[y]=h.words[y];return this},m.prototype.add=function(t){var n;return t.negative!==0&&this.negative===0?(t.negative=0,n=this.sub(t),t.negative^=1,n):t.negative===0&&this.negative!==0?(this.negative=0,n=t.sub(this),this.negative=1,n):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},m.prototype.isub=function(t){if(t.negative!==0){t.negative=0;var n=this.iadd(t);return t.negative=1,n._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var h=this.cmp(t);if(h===0)return this.negative=0,this.length=1,this.words[0]=0,this;var f,d;h>0?(f=this,d=t):(f=t,d=this);for(var y=0,_=0;_<d.length;_++)n=(f.words[_]|0)-(d.words[_]|0)+y,y=n>>26,this.words[_]=n&67108863;for(;y!==0&&_<f.length;_++)n=(f.words[_]|0)+y,y=n>>26,this.words[_]=n&67108863;if(y===0&&_<f.length&&f!==this)for(;_<f.length;_++)this.words[_]=f.words[_];return this.length=Math.max(this.length,_),f!==this&&(this.negative=1),this.strip()},m.prototype.sub=function(t){return this.clone().isub(t)};function xt(g,t,n){n.negative=t.negative^g.negative;var h=g.length+t.length|0;n.length=h,h=h-1|0;var f=g.words[0]|0,d=t.words[0]|0,y=f*d,_=y&67108863,c=y/67108864|0;n.words[0]=_;for(var i=1;i<h;i++){for(var l=c>>>26,R=c&67108863,k=Math.min(i,t.length-1),T=Math.max(0,i-g.length+1);T<=k;T++){var O=i-T|0;f=g.words[O]|0,d=t.words[T]|0,y=f*d+R,l+=y/67108864|0,R=y&67108863}n.words[i]=R|0,c=l|0}return c!==0?n.words[i]=c|0:n.length--,n.strip()}var Tt=function(t,n,h){var f=t.words,d=n.words,y=h.words,_=0,c,i,l,R=f[0]|0,k=R&8191,T=R>>>13,O=f[1]|0,D=O&8191,Z=O>>>13,St=f[2]|0,H=St&8191,W=St>>>13,$t=f[3]|0,tt=$t&8191,Y=$t>>>13,At=f[4]|0,G=At&8191,et=At>>>13,Zt=f[5]|0,K=Zt&8191,rt=Zt>>>13,Wt=f[6]|0,X=Wt&8191,J=Wt>>>13,bt=f[7]|0,Q=bt&8191,it=bt>>>13,Rt=f[8]|0,nt=Rt&8191,o=Rt>>>13,e=f[9]|0,r=e&8191,a=e>>>13,v=d[0]|0,M=v&8191,I=v>>>13,L=d[1]|0,q=L&8191,F=L>>>13,z=d[2]|0,U=z&8191,st=z>>>13,Ee=d[3]|0,ot=Ee&8191,ht=Ee>>>13,Se=d[4]|0,at=Se&8191,ft=Se>>>13,Re=d[5]|0,ut=Re&8191,ct=Re>>>13,Be=d[6]|0,lt=Be&8191,dt=Be>>>13,ke=d[7]|0,pt=ke&8191,mt=ke>>>13,Ae=d[8]|0,gt=Ae&8191,yt=Ae>>>13,Te=d[9]|0,wt=Te&8191,vt=Te>>>13;h.negative=t.negative^n.negative,h.length=19,c=Math.imul(k,M),i=Math.imul(k,I),i=i+Math.imul(T,M)|0,l=Math.imul(T,I);var Qt=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,c=Math.imul(D,M),i=Math.imul(D,I),i=i+Math.imul(Z,M)|0,l=Math.imul(Z,I),c=c+Math.imul(k,q)|0,i=i+Math.imul(k,F)|0,i=i+Math.imul(T,q)|0,l=l+Math.imul(T,F)|0;var Vt=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(Vt>>>26)|0,Vt&=67108863,c=Math.imul(H,M),i=Math.imul(H,I),i=i+Math.imul(W,M)|0,l=Math.imul(W,I),c=c+Math.imul(D,q)|0,i=i+Math.imul(D,F)|0,i=i+Math.imul(Z,q)|0,l=l+Math.imul(Z,F)|0,c=c+Math.imul(k,U)|0,i=i+Math.imul(k,st)|0,i=i+Math.imul(T,U)|0,l=l+Math.imul(T,st)|0;var Yt=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,c=Math.imul(tt,M),i=Math.imul(tt,I),i=i+Math.imul(Y,M)|0,l=Math.imul(Y,I),c=c+Math.imul(H,q)|0,i=i+Math.imul(H,F)|0,i=i+Math.imul(W,q)|0,l=l+Math.imul(W,F)|0,c=c+Math.imul(D,U)|0,i=i+Math.imul(D,st)|0,i=i+Math.imul(Z,U)|0,l=l+Math.imul(Z,st)|0,c=c+Math.imul(k,ot)|0,i=i+Math.imul(k,ht)|0,i=i+Math.imul(T,ot)|0,l=l+Math.imul(T,ht)|0;var Xt=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,c=Math.imul(G,M),i=Math.imul(G,I),i=i+Math.imul(et,M)|0,l=Math.imul(et,I),c=c+Math.imul(tt,q)|0,i=i+Math.imul(tt,F)|0,i=i+Math.imul(Y,q)|0,l=l+Math.imul(Y,F)|0,c=c+Math.imul(H,U)|0,i=i+Math.imul(H,st)|0,i=i+Math.imul(W,U)|0,l=l+Math.imul(W,st)|0,c=c+Math.imul(D,ot)|0,i=i+Math.imul(D,ht)|0,i=i+Math.imul(Z,ot)|0,l=l+Math.imul(Z,ht)|0,c=c+Math.imul(k,at)|0,i=i+Math.imul(k,ft)|0,i=i+Math.imul(T,at)|0,l=l+Math.imul(T,ft)|0;var te=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(te>>>26)|0,te&=67108863,c=Math.imul(K,M),i=Math.imul(K,I),i=i+Math.imul(rt,M)|0,l=Math.imul(rt,I),c=c+Math.imul(G,q)|0,i=i+Math.imul(G,F)|0,i=i+Math.imul(et,q)|0,l=l+Math.imul(et,F)|0,c=c+Math.imul(tt,U)|0,i=i+Math.imul(tt,st)|0,i=i+Math.imul(Y,U)|0,l=l+Math.imul(Y,st)|0,c=c+Math.imul(H,ot)|0,i=i+Math.imul(H,ht)|0,i=i+Math.imul(W,ot)|0,l=l+Math.imul(W,ht)|0,c=c+Math.imul(D,at)|0,i=i+Math.imul(D,ft)|0,i=i+Math.imul(Z,at)|0,l=l+Math.imul(Z,ft)|0,c=c+Math.imul(k,ut)|0,i=i+Math.imul(k,ct)|0,i=i+Math.imul(T,ut)|0,l=l+Math.imul(T,ct)|0;var ee=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(ee>>>26)|0,ee&=67108863,c=Math.imul(X,M),i=Math.imul(X,I),i=i+Math.imul(J,M)|0,l=Math.imul(J,I),c=c+Math.imul(K,q)|0,i=i+Math.imul(K,F)|0,i=i+Math.imul(rt,q)|0,l=l+Math.imul(rt,F)|0,c=c+Math.imul(G,U)|0,i=i+Math.imul(G,st)|0,i=i+Math.imul(et,U)|0,l=l+Math.imul(et,st)|0,c=c+Math.imul(tt,ot)|0,i=i+Math.imul(tt,ht)|0,i=i+Math.imul(Y,ot)|0,l=l+Math.imul(Y,ht)|0,c=c+Math.imul(H,at)|0,i=i+Math.imul(H,ft)|0,i=i+Math.imul(W,at)|0,l=l+Math.imul(W,ft)|0,c=c+Math.imul(D,ut)|0,i=i+Math.imul(D,ct)|0,i=i+Math.imul(Z,ut)|0,l=l+Math.imul(Z,ct)|0,c=c+Math.imul(k,lt)|0,i=i+Math.imul(k,dt)|0,i=i+Math.imul(T,lt)|0,l=l+Math.imul(T,dt)|0;var re=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(re>>>26)|0,re&=67108863,c=Math.imul(Q,M),i=Math.imul(Q,I),i=i+Math.imul(it,M)|0,l=Math.imul(it,I),c=c+Math.imul(X,q)|0,i=i+Math.imul(X,F)|0,i=i+Math.imul(J,q)|0,l=l+Math.imul(J,F)|0,c=c+Math.imul(K,U)|0,i=i+Math.imul(K,st)|0,i=i+Math.imul(rt,U)|0,l=l+Math.imul(rt,st)|0,c=c+Math.imul(G,ot)|0,i=i+Math.imul(G,ht)|0,i=i+Math.imul(et,ot)|0,l=l+Math.imul(et,ht)|0,c=c+Math.imul(tt,at)|0,i=i+Math.imul(tt,ft)|0,i=i+Math.imul(Y,at)|0,l=l+Math.imul(Y,ft)|0,c=c+Math.imul(H,ut)|0,i=i+Math.imul(H,ct)|0,i=i+Math.imul(W,ut)|0,l=l+Math.imul(W,ct)|0,c=c+Math.imul(D,lt)|0,i=i+Math.imul(D,dt)|0,i=i+Math.imul(Z,lt)|0,l=l+Math.imul(Z,dt)|0,c=c+Math.imul(k,pt)|0,i=i+Math.imul(k,mt)|0,i=i+Math.imul(T,pt)|0,l=l+Math.imul(T,mt)|0;var ie=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(ie>>>26)|0,ie&=67108863,c=Math.imul(nt,M),i=Math.imul(nt,I),i=i+Math.imul(o,M)|0,l=Math.imul(o,I),c=c+Math.imul(Q,q)|0,i=i+Math.imul(Q,F)|0,i=i+Math.imul(it,q)|0,l=l+Math.imul(it,F)|0,c=c+Math.imul(X,U)|0,i=i+Math.imul(X,st)|0,i=i+Math.imul(J,U)|0,l=l+Math.imul(J,st)|0,c=c+Math.imul(K,ot)|0,i=i+Math.imul(K,ht)|0,i=i+Math.imul(rt,ot)|0,l=l+Math.imul(rt,ht)|0,c=c+Math.imul(G,at)|0,i=i+Math.imul(G,ft)|0,i=i+Math.imul(et,at)|0,l=l+Math.imul(et,ft)|0,c=c+Math.imul(tt,ut)|0,i=i+Math.imul(tt,ct)|0,i=i+Math.imul(Y,ut)|0,l=l+Math.imul(Y,ct)|0,c=c+Math.imul(H,lt)|0,i=i+Math.imul(H,dt)|0,i=i+Math.imul(W,lt)|0,l=l+Math.imul(W,dt)|0,c=c+Math.imul(D,pt)|0,i=i+Math.imul(D,mt)|0,i=i+Math.imul(Z,pt)|0,l=l+Math.imul(Z,mt)|0,c=c+Math.imul(k,gt)|0,i=i+Math.imul(k,yt)|0,i=i+Math.imul(T,gt)|0,l=l+Math.imul(T,yt)|0;var ne=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(ne>>>26)|0,ne&=67108863,c=Math.imul(r,M),i=Math.imul(r,I),i=i+Math.imul(a,M)|0,l=Math.imul(a,I),c=c+Math.imul(nt,q)|0,i=i+Math.imul(nt,F)|0,i=i+Math.imul(o,q)|0,l=l+Math.imul(o,F)|0,c=c+Math.imul(Q,U)|0,i=i+Math.imul(Q,st)|0,i=i+Math.imul(it,U)|0,l=l+Math.imul(it,st)|0,c=c+Math.imul(X,ot)|0,i=i+Math.imul(X,ht)|0,i=i+Math.imul(J,ot)|0,l=l+Math.imul(J,ht)|0,c=c+Math.imul(K,at)|0,i=i+Math.imul(K,ft)|0,i=i+Math.imul(rt,at)|0,l=l+Math.imul(rt,ft)|0,c=c+Math.imul(G,ut)|0,i=i+Math.imul(G,ct)|0,i=i+Math.imul(et,ut)|0,l=l+Math.imul(et,ct)|0,c=c+Math.imul(tt,lt)|0,i=i+Math.imul(tt,dt)|0,i=i+Math.imul(Y,lt)|0,l=l+Math.imul(Y,dt)|0,c=c+Math.imul(H,pt)|0,i=i+Math.imul(H,mt)|0,i=i+Math.imul(W,pt)|0,l=l+Math.imul(W,mt)|0,c=c+Math.imul(D,gt)|0,i=i+Math.imul(D,yt)|0,i=i+Math.imul(Z,gt)|0,l=l+Math.imul(Z,yt)|0,c=c+Math.imul(k,wt)|0,i=i+Math.imul(k,vt)|0,i=i+Math.imul(T,wt)|0,l=l+Math.imul(T,vt)|0;var se=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(se>>>26)|0,se&=67108863,c=Math.imul(r,q),i=Math.imul(r,F),i=i+Math.imul(a,q)|0,l=Math.imul(a,F),c=c+Math.imul(nt,U)|0,i=i+Math.imul(nt,st)|0,i=i+Math.imul(o,U)|0,l=l+Math.imul(o,st)|0,c=c+Math.imul(Q,ot)|0,i=i+Math.imul(Q,ht)|0,i=i+Math.imul(it,ot)|0,l=l+Math.imul(it,ht)|0,c=c+Math.imul(X,at)|0,i=i+Math.imul(X,ft)|0,i=i+Math.imul(J,at)|0,l=l+Math.imul(J,ft)|0,c=c+Math.imul(K,ut)|0,i=i+Math.imul(K,ct)|0,i=i+Math.imul(rt,ut)|0,l=l+Math.imul(rt,ct)|0,c=c+Math.imul(G,lt)|0,i=i+Math.imul(G,dt)|0,i=i+Math.imul(et,lt)|0,l=l+Math.imul(et,dt)|0,c=c+Math.imul(tt,pt)|0,i=i+Math.imul(tt,mt)|0,i=i+Math.imul(Y,pt)|0,l=l+Math.imul(Y,mt)|0,c=c+Math.imul(H,gt)|0,i=i+Math.imul(H,yt)|0,i=i+Math.imul(W,gt)|0,l=l+Math.imul(W,yt)|0,c=c+Math.imul(D,wt)|0,i=i+Math.imul(D,vt)|0,i=i+Math.imul(Z,wt)|0,l=l+Math.imul(Z,vt)|0;var oe=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(oe>>>26)|0,oe&=67108863,c=Math.imul(r,U),i=Math.imul(r,st),i=i+Math.imul(a,U)|0,l=Math.imul(a,st),c=c+Math.imul(nt,ot)|0,i=i+Math.imul(nt,ht)|0,i=i+Math.imul(o,ot)|0,l=l+Math.imul(o,ht)|0,c=c+Math.imul(Q,at)|0,i=i+Math.imul(Q,ft)|0,i=i+Math.imul(it,at)|0,l=l+Math.imul(it,ft)|0,c=c+Math.imul(X,ut)|0,i=i+Math.imul(X,ct)|0,i=i+Math.imul(J,ut)|0,l=l+Math.imul(J,ct)|0,c=c+Math.imul(K,lt)|0,i=i+Math.imul(K,dt)|0,i=i+Math.imul(rt,lt)|0,l=l+Math.imul(rt,dt)|0,c=c+Math.imul(G,pt)|0,i=i+Math.imul(G,mt)|0,i=i+Math.imul(et,pt)|0,l=l+Math.imul(et,mt)|0,c=c+Math.imul(tt,gt)|0,i=i+Math.imul(tt,yt)|0,i=i+Math.imul(Y,gt)|0,l=l+Math.imul(Y,yt)|0,c=c+Math.imul(H,wt)|0,i=i+Math.imul(H,vt)|0,i=i+Math.imul(W,wt)|0,l=l+Math.imul(W,vt)|0;var he=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(he>>>26)|0,he&=67108863,c=Math.imul(r,ot),i=Math.imul(r,ht),i=i+Math.imul(a,ot)|0,l=Math.imul(a,ht),c=c+Math.imul(nt,at)|0,i=i+Math.imul(nt,ft)|0,i=i+Math.imul(o,at)|0,l=l+Math.imul(o,ft)|0,c=c+Math.imul(Q,ut)|0,i=i+Math.imul(Q,ct)|0,i=i+Math.imul(it,ut)|0,l=l+Math.imul(it,ct)|0,c=c+Math.imul(X,lt)|0,i=i+Math.imul(X,dt)|0,i=i+Math.imul(J,lt)|0,l=l+Math.imul(J,dt)|0,c=c+Math.imul(K,pt)|0,i=i+Math.imul(K,mt)|0,i=i+Math.imul(rt,pt)|0,l=l+Math.imul(rt,mt)|0,c=c+Math.imul(G,gt)|0,i=i+Math.imul(G,yt)|0,i=i+Math.imul(et,gt)|0,l=l+Math.imul(et,yt)|0,c=c+Math.imul(tt,wt)|0,i=i+Math.imul(tt,vt)|0,i=i+Math.imul(Y,wt)|0,l=l+Math.imul(Y,vt)|0;var ae=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(ae>>>26)|0,ae&=67108863,c=Math.imul(r,at),i=Math.imul(r,ft),i=i+Math.imul(a,at)|0,l=Math.imul(a,ft),c=c+Math.imul(nt,ut)|0,i=i+Math.imul(nt,ct)|0,i=i+Math.imul(o,ut)|0,l=l+Math.imul(o,ct)|0,c=c+Math.imul(Q,lt)|0,i=i+Math.imul(Q,dt)|0,i=i+Math.imul(it,lt)|0,l=l+Math.imul(it,dt)|0,c=c+Math.imul(X,pt)|0,i=i+Math.imul(X,mt)|0,i=i+Math.imul(J,pt)|0,l=l+Math.imul(J,mt)|0,c=c+Math.imul(K,gt)|0,i=i+Math.imul(K,yt)|0,i=i+Math.imul(rt,gt)|0,l=l+Math.imul(rt,yt)|0,c=c+Math.imul(G,wt)|0,i=i+Math.imul(G,vt)|0,i=i+Math.imul(et,wt)|0,l=l+Math.imul(et,vt)|0;var fe=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(fe>>>26)|0,fe&=67108863,c=Math.imul(r,ut),i=Math.imul(r,ct),i=i+Math.imul(a,ut)|0,l=Math.imul(a,ct),c=c+Math.imul(nt,lt)|0,i=i+Math.imul(nt,dt)|0,i=i+Math.imul(o,lt)|0,l=l+Math.imul(o,dt)|0,c=c+Math.imul(Q,pt)|0,i=i+Math.imul(Q,mt)|0,i=i+Math.imul(it,pt)|0,l=l+Math.imul(it,mt)|0,c=c+Math.imul(X,gt)|0,i=i+Math.imul(X,yt)|0,i=i+Math.imul(J,gt)|0,l=l+Math.imul(J,yt)|0,c=c+Math.imul(K,wt)|0,i=i+Math.imul(K,vt)|0,i=i+Math.imul(rt,wt)|0,l=l+Math.imul(rt,vt)|0;var ue=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(ue>>>26)|0,ue&=67108863,c=Math.imul(r,lt),i=Math.imul(r,dt),i=i+Math.imul(a,lt)|0,l=Math.imul(a,dt),c=c+Math.imul(nt,pt)|0,i=i+Math.imul(nt,mt)|0,i=i+Math.imul(o,pt)|0,l=l+Math.imul(o,mt)|0,c=c+Math.imul(Q,gt)|0,i=i+Math.imul(Q,yt)|0,i=i+Math.imul(it,gt)|0,l=l+Math.imul(it,yt)|0,c=c+Math.imul(X,wt)|0,i=i+Math.imul(X,vt)|0,i=i+Math.imul(J,wt)|0,l=l+Math.imul(J,vt)|0;var ce=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(ce>>>26)|0,ce&=67108863,c=Math.imul(r,pt),i=Math.imul(r,mt),i=i+Math.imul(a,pt)|0,l=Math.imul(a,mt),c=c+Math.imul(nt,gt)|0,i=i+Math.imul(nt,yt)|0,i=i+Math.imul(o,gt)|0,l=l+Math.imul(o,yt)|0,c=c+Math.imul(Q,wt)|0,i=i+Math.imul(Q,vt)|0,i=i+Math.imul(it,wt)|0,l=l+Math.imul(it,vt)|0;var le=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(le>>>26)|0,le&=67108863,c=Math.imul(r,gt),i=Math.imul(r,yt),i=i+Math.imul(a,gt)|0,l=Math.imul(a,yt),c=c+Math.imul(nt,wt)|0,i=i+Math.imul(nt,vt)|0,i=i+Math.imul(o,wt)|0,l=l+Math.imul(o,vt)|0;var de=(_+c|0)+((i&8191)<<13)|0;_=(l+(i>>>13)|0)+(de>>>26)|0,de&=67108863,c=Math.imul(r,wt),i=Math.imul(r,vt),i=i+Math.imul(a,wt)|0,l=Math.imul(a,vt);var pe=(_+c|0)+((i&8191)<<13)|0;return _=(l+(i>>>13)|0)+(pe>>>26)|0,pe&=67108863,y[0]=Qt,y[1]=Vt,y[2]=Yt,y[3]=Xt,y[4]=te,y[5]=ee,y[6]=re,y[7]=ie,y[8]=ne,y[9]=se,y[10]=oe,y[11]=he,y[12]=ae,y[13]=fe,y[14]=ue,y[15]=ce,y[16]=le,y[17]=de,y[18]=pe,_!==0&&(y[19]=_,h.length++),h};Math.imul||(Tt=xt);function Ut(g,t,n){n.negative=t.negative^g.negative,n.length=g.length+t.length;for(var h=0,f=0,d=0;d<n.length-1;d++){var y=f;f=0;for(var _=h&67108863,c=Math.min(d,t.length-1),i=Math.max(0,d-g.length+1);i<=c;i++){var l=d-i,R=g.words[l]|0,k=t.words[i]|0,T=R*k,O=T&67108863;y=y+(T/67108864|0)|0,O=O+_|0,_=O&67108863,y=y+(O>>>26)|0,f+=y>>>26,y&=67108863}n.words[d]=_,h=y,y=f}return h!==0?n.words[d]=h:n.length--,n.strip()}function E(g,t,n){var h=new S;return h.mulp(g,t,n)}m.prototype.mulTo=function(t,n){var h,f=this.length+t.length;return this.length===10&&t.length===10?h=Tt(this,t,n):f<63?h=xt(this,t,n):f<1024?h=Ut(this,t,n):h=E(this,t,n),h};function S(g,t){this.x=g,this.y=t}S.prototype.makeRBT=function(t){for(var n=new Array(t),h=m.prototype._countBits(t)-1,f=0;f<t;f++)n[f]=this.revBin(f,h,t);return n},S.prototype.revBin=function(t,n,h){if(t===0||t===h-1)return t;for(var f=0,d=0;d<n;d++)f|=(t&1)<<n-d-1,t>>=1;return f},S.prototype.permute=function(t,n,h,f,d,y){for(var _=0;_<y;_++)f[_]=n[t[_]],d[_]=h[t[_]]},S.prototype.transform=function(t,n,h,f,d,y){this.permute(y,t,n,h,f,d);for(var _=1;_<d;_<<=1)for(var c=_<<1,i=Math.cos(2*Math.PI/c),l=Math.sin(2*Math.PI/c),R=0;R<d;R+=c)for(var k=i,T=l,O=0;O<_;O++){var D=h[R+O],Z=f[R+O],St=h[R+O+_],H=f[R+O+_],W=k*St-T*H;H=k*H+T*St,St=W,h[R+O]=D+St,f[R+O]=Z+H,h[R+O+_]=D-St,f[R+O+_]=Z-H,O!==c&&(W=i*k-l*T,T=i*T+l*k,k=W)}},S.prototype.guessLen13b=function(t,n){var h=Math.max(n,t)|1,f=h&1,d=0;for(h=h/2|0;h;h=h>>>1)d++;return 1<<d+1+f},S.prototype.conjugate=function(t,n,h){if(!(h<=1))for(var f=0;f<h/2;f++){var d=t[f];t[f]=t[h-f-1],t[h-f-1]=d,d=n[f],n[f]=-n[h-f-1],n[h-f-1]=-d}},S.prototype.normalize13b=function(t,n){for(var h=0,f=0;f<n/2;f++){var d=Math.round(t[2*f+1]/n)*8192+Math.round(t[2*f]/n)+h;t[f]=d&67108863,d<67108864?h=0:h=d/67108864|0}return t},S.prototype.convert13b=function(t,n,h,f){for(var d=0,y=0;y<n;y++)d=d+(t[y]|0),h[2*y]=d&8191,d=d>>>13,h[2*y+1]=d&8191,d=d>>>13;for(y=2*n;y<f;++y)h[y]=0;w(d===0),w((d&-8192)===0)},S.prototype.stub=function(t){for(var n=new Array(t),h=0;h<t;h++)n[h]=0;return n},S.prototype.mulp=function(t,n,h){var f=2*this.guessLen13b(t.length,n.length),d=this.makeRBT(f),y=this.stub(f),_=new Array(f),c=new Array(f),i=new Array(f),l=new Array(f),R=new Array(f),k=new Array(f),T=h.words;T.length=f,this.convert13b(t.words,t.length,_,f),this.convert13b(n.words,n.length,l,f),this.transform(_,y,c,i,f,d),this.transform(l,y,R,k,f,d);for(var O=0;O<f;O++){var D=c[O]*R[O]-i[O]*k[O];i[O]=c[O]*k[O]+i[O]*R[O],c[O]=D}return this.conjugate(c,i,f),this.transform(c,i,T,y,f,d),this.conjugate(T,y,f),this.normalize13b(T,f),h.negative=t.negative^n.negative,h.length=t.length+n.length,h.strip()},m.prototype.mul=function(t){var n=new m(null);return n.words=new Array(this.length+t.length),this.mulTo(t,n)},m.prototype.mulf=function(t){var n=new m(null);return n.words=new Array(this.length+t.length),E(this,t,n)},m.prototype.imul=function(t){return this.clone().mulTo(t,this)},m.prototype.imuln=function(t){w(typeof t=="number"),w(t<67108864);for(var n=0,h=0;h<this.length;h++){var f=(this.words[h]|0)*t,d=(f&67108863)+(n&67108863);n>>=26,n+=f/67108864|0,n+=d>>>26,this.words[h]=d&67108863}return n!==0&&(this.words[h]=n,this.length++),this},m.prototype.muln=function(t){return this.clone().imuln(t)},m.prototype.sqr=function(){return this.mul(this)},m.prototype.isqr=function(){return this.imul(this.clone())},m.prototype.pow=function(t){var n=Et(t);if(n.length===0)return new m(1);for(var h=this,f=0;f<n.length&&n[f]===0;f++,h=h.sqr());if(++f<n.length)for(var d=h.sqr();f<n.length;f++,d=d.sqr())n[f]!==0&&(h=h.mul(d));return h},m.prototype.iushln=function(t){w(typeof t=="number"&&t>=0);var n=t%26,h=(t-n)/26,f=67108863>>>26-n<<26-n,d;if(n!==0){var y=0;for(d=0;d<this.length;d++){var _=this.words[d]&f,c=(this.words[d]|0)-_<<n;this.words[d]=c|y,y=_>>>26-n}y&&(this.words[d]=y,this.length++)}if(h!==0){for(d=this.length-1;d>=0;d--)this.words[d+h]=this.words[d];for(d=0;d<h;d++)this.words[d]=0;this.length+=h}return this.strip()},m.prototype.ishln=function(t){return w(this.negative===0),this.iushln(t)},m.prototype.iushrn=function(t,n,h){w(typeof t=="number"&&t>=0);var f;n?f=(n-n%26)/26:f=0;var d=t%26,y=Math.min((t-d)/26,this.length),_=67108863^67108863>>>d<<d,c=h;if(f-=y,f=Math.max(0,f),c){for(var i=0;i<y;i++)c.words[i]=this.words[i];c.length=y}if(y!==0)if(this.length>y)for(this.length-=y,i=0;i<this.length;i++)this.words[i]=this.words[i+y];else this.words[0]=0,this.length=1;var l=0;for(i=this.length-1;i>=0&&(l!==0||i>=f);i--){var R=this.words[i]|0;this.words[i]=l<<26-d|R>>>d,l=R&_}return c&&l!==0&&(c.words[c.length++]=l),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},m.prototype.ishrn=function(t,n,h){return w(this.negative===0),this.iushrn(t,n,h)},m.prototype.shln=function(t){return this.clone().ishln(t)},m.prototype.ushln=function(t){return this.clone().iushln(t)},m.prototype.shrn=function(t){return this.clone().ishrn(t)},m.prototype.ushrn=function(t){return this.clone().iushrn(t)},m.prototype.testn=function(t){w(typeof t=="number"&&t>=0);var n=t%26,h=(t-n)/26,f=1<<n;if(this.length<=h)return!1;var d=this.words[h];return!!(d&f)},m.prototype.imaskn=function(t){w(typeof t=="number"&&t>=0);var n=t%26,h=(t-n)/26;if(w(this.negative===0,"imaskn works only with positive numbers"),this.length<=h)return this;if(n!==0&&h++,this.length=Math.min(h,this.length),n!==0){var f=67108863^67108863>>>n<<n;this.words[this.length-1]&=f}return this.strip()},m.prototype.maskn=function(t){return this.clone().imaskn(t)},m.prototype.iaddn=function(t){return w(typeof t=="number"),w(t<67108864),t<0?this.isubn(-t):this.negative!==0?this.length===1&&(this.words[0]|0)<t?(this.words[0]=t-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},m.prototype._iaddn=function(t){this.words[0]+=t;for(var n=0;n<this.length&&this.words[n]>=67108864;n++)this.words[n]-=67108864,n===this.length-1?this.words[n+1]=1:this.words[n+1]++;return this.length=Math.max(this.length,n+1),this},m.prototype.isubn=function(t){if(w(typeof t=="number"),w(t<67108864),t<0)return this.iaddn(-t);if(this.negative!==0)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var n=0;n<this.length&&this.words[n]<0;n++)this.words[n]+=67108864,this.words[n+1]-=1;return this.strip()},m.prototype.addn=function(t){return this.clone().iaddn(t)},m.prototype.subn=function(t){return this.clone().isubn(t)},m.prototype.iabs=function(){return this.negative=0,this},m.prototype.abs=function(){return this.clone().iabs()},m.prototype._ishlnsubmul=function(t,n,h){var f=t.length+h,d;this._expand(f);var y,_=0;for(d=0;d<t.length;d++){y=(this.words[d+h]|0)+_;var c=(t.words[d]|0)*n;y-=c&67108863,_=(y>>26)-(c/67108864|0),this.words[d+h]=y&67108863}for(;d<this.length-h;d++)y=(this.words[d+h]|0)+_,_=y>>26,this.words[d+h]=y&67108863;if(_===0)return this.strip();for(w(_===-1),_=0,d=0;d<this.length;d++)y=-(this.words[d]|0)+_,_=y>>26,this.words[d]=y&67108863;return this.negative=1,this.strip()},m.prototype._wordDiv=function(t,n){var h=this.length-t.length,f=this.clone(),d=t,y=d.words[d.length-1]|0,_=this._countBits(y);h=26-_,h!==0&&(d=d.ushln(h),f.iushln(h),y=d.words[d.length-1]|0);var c=f.length-d.length,i;if(n!=="mod"){i=new m(null),i.length=c+1,i.words=new Array(i.length);for(var l=0;l<i.length;l++)i.words[l]=0}var R=f.clone()._ishlnsubmul(d,1,c);R.negative===0&&(f=R,i&&(i.words[c]=1));for(var k=c-1;k>=0;k--){var T=(f.words[d.length+k]|0)*67108864+(f.words[d.length+k-1]|0);for(T=Math.min(T/y|0,67108863),f._ishlnsubmul(d,T,k);f.negative!==0;)T--,f.negative=0,f._ishlnsubmul(d,1,k),f.isZero()||(f.negative^=1);i&&(i.words[k]=T)}return i&&i.strip(),f.strip(),n!=="div"&&h!==0&&f.iushrn(h),{div:i||null,mod:f}},m.prototype.divmod=function(t,n,h){if(w(!t.isZero()),this.isZero())return{div:new m(0),mod:new m(0)};var f,d,y;return this.negative!==0&&t.negative===0?(y=this.neg().divmod(t,n),n!=="mod"&&(f=y.div.neg()),n!=="div"&&(d=y.mod.neg(),h&&d.negative!==0&&d.iadd(t)),{div:f,mod:d}):this.negative===0&&t.negative!==0?(y=this.divmod(t.neg(),n),n!=="mod"&&(f=y.div.neg()),{div:f,mod:y.mod}):this.negative&t.negative?(y=this.neg().divmod(t.neg(),n),n!=="div"&&(d=y.mod.neg(),h&&d.negative!==0&&d.isub(t)),{div:y.div,mod:d}):t.length>this.length||this.cmp(t)<0?{div:new m(0),mod:this}:t.length===1?n==="div"?{div:this.divn(t.words[0]),mod:null}:n==="mod"?{div:null,mod:new m(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new m(this.modn(t.words[0]))}:this._wordDiv(t,n)},m.prototype.div=function(t){return this.divmod(t,"div",!1).div},m.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},m.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},m.prototype.divRound=function(t){var n=this.divmod(t);if(n.mod.isZero())return n.div;var h=n.div.negative!==0?n.mod.isub(t):n.mod,f=t.ushrn(1),d=t.andln(1),y=h.cmp(f);return y<0||d===1&&y===0?n.div:n.div.negative!==0?n.div.isubn(1):n.div.iaddn(1)},m.prototype.modn=function(t){w(t<=67108863);for(var n=(1<<26)%t,h=0,f=this.length-1;f>=0;f--)h=(n*h+(this.words[f]|0))%t;return h},m.prototype.idivn=function(t){w(t<=67108863);for(var n=0,h=this.length-1;h>=0;h--){var f=(this.words[h]|0)+n*67108864;this.words[h]=f/t|0,n=f%t}return this.strip()},m.prototype.divn=function(t){return this.clone().idivn(t)},m.prototype.egcd=function(t){w(t.negative===0),w(!t.isZero());var n=this,h=t.clone();n.negative!==0?n=n.umod(t):n=n.clone();for(var f=new m(1),d=new m(0),y=new m(0),_=new m(1),c=0;n.isEven()&&h.isEven();)n.iushrn(1),h.iushrn(1),++c;for(var i=h.clone(),l=n.clone();!n.isZero();){for(var R=0,k=1;!(n.words[0]&k)&&R<26;++R,k<<=1);if(R>0)for(n.iushrn(R);R-- >0;)(f.isOdd()||d.isOdd())&&(f.iadd(i),d.isub(l)),f.iushrn(1),d.iushrn(1);for(var T=0,O=1;!(h.words[0]&O)&&T<26;++T,O<<=1);if(T>0)for(h.iushrn(T);T-- >0;)(y.isOdd()||_.isOdd())&&(y.iadd(i),_.isub(l)),y.iushrn(1),_.iushrn(1);n.cmp(h)>=0?(n.isub(h),f.isub(y),d.isub(_)):(h.isub(n),y.isub(f),_.isub(d))}return{a:y,b:_,gcd:h.iushln(c)}},m.prototype._invmp=function(t){w(t.negative===0),w(!t.isZero());var n=this,h=t.clone();n.negative!==0?n=n.umod(t):n=n.clone();for(var f=new m(1),d=new m(0),y=h.clone();n.cmpn(1)>0&&h.cmpn(1)>0;){for(var _=0,c=1;!(n.words[0]&c)&&_<26;++_,c<<=1);if(_>0)for(n.iushrn(_);_-- >0;)f.isOdd()&&f.iadd(y),f.iushrn(1);for(var i=0,l=1;!(h.words[0]&l)&&i<26;++i,l<<=1);if(i>0)for(h.iushrn(i);i-- >0;)d.isOdd()&&d.iadd(y),d.iushrn(1);n.cmp(h)>=0?(n.isub(h),f.isub(d)):(h.isub(n),d.isub(f))}var R;return n.cmpn(1)===0?R=f:R=d,R.cmpn(0)<0&&R.iadd(t),R},m.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var n=this.clone(),h=t.clone();n.negative=0,h.negative=0;for(var f=0;n.isEven()&&h.isEven();f++)n.iushrn(1),h.iushrn(1);do{for(;n.isEven();)n.iushrn(1);for(;h.isEven();)h.iushrn(1);var d=n.cmp(h);if(d<0){var y=n;n=h,h=y}else if(d===0||h.cmpn(1)===0)break;n.isub(h)}while(!0);return h.iushln(f)},m.prototype.invm=function(t){return this.egcd(t).a.umod(t)},m.prototype.isEven=function(){return(this.words[0]&1)===0},m.prototype.isOdd=function(){return(this.words[0]&1)===1},m.prototype.andln=function(t){return this.words[0]&t},m.prototype.bincn=function(t){w(typeof t=="number");var n=t%26,h=(t-n)/26,f=1<<n;if(this.length<=h)return this._expand(h+1),this.words[h]|=f,this;for(var d=f,y=h;d!==0&&y<this.length;y++){var _=this.words[y]|0;_+=d,d=_>>>26,_&=67108863,this.words[y]=_}return d!==0&&(this.words[y]=d,this.length++),this},m.prototype.isZero=function(){return this.length===1&&this.words[0]===0},m.prototype.cmpn=function(t){var n=t<0;if(this.negative!==0&&!n)return-1;if(this.negative===0&&n)return 1;this.strip();var h;if(this.length>1)h=1;else{n&&(t=-t),w(t<=67108863,"Number is too big");var f=this.words[0]|0;h=f===t?0:f<t?-1:1}return this.negative!==0?-h|0:h},m.prototype.cmp=function(t){if(this.negative!==0&&t.negative===0)return-1;if(this.negative===0&&t.negative!==0)return 1;var n=this.ucmp(t);return this.negative!==0?-n|0:n},m.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var n=0,h=this.length-1;h>=0;h--){var f=this.words[h]|0,d=t.words[h]|0;if(f!==d){f<d?n=-1:f>d&&(n=1);break}}return n},m.prototype.gtn=function(t){return this.cmpn(t)===1},m.prototype.gt=function(t){return this.cmp(t)===1},m.prototype.gten=function(t){return this.cmpn(t)>=0},m.prototype.gte=function(t){return this.cmp(t)>=0},m.prototype.ltn=function(t){return this.cmpn(t)===-1},m.prototype.lt=function(t){return this.cmp(t)===-1},m.prototype.lten=function(t){return this.cmpn(t)<=0},m.prototype.lte=function(t){return this.cmp(t)<=0},m.prototype.eqn=function(t){return this.cmpn(t)===0},m.prototype.eq=function(t){return this.cmp(t)===0},m.red=function(t){return new V(t)},m.prototype.toRed=function(t){return w(!this.red,"Already a number in reduction context"),w(this.negative===0,"red works only with positives"),t.convertTo(this)._forceRed(t)},m.prototype.fromRed=function(){return w(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},m.prototype._forceRed=function(t){return this.red=t,this},m.prototype.forceRed=function(t){return w(!this.red,"Already a number in reduction context"),this._forceRed(t)},m.prototype.redAdd=function(t){return w(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},m.prototype.redIAdd=function(t){return w(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},m.prototype.redSub=function(t){return w(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},m.prototype.redISub=function(t){return w(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},m.prototype.redShl=function(t){return w(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},m.prototype.redMul=function(t){return w(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},m.prototype.redIMul=function(t){return w(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},m.prototype.redSqr=function(){return w(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},m.prototype.redISqr=function(){return w(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},m.prototype.redSqrt=function(){return w(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},m.prototype.redInvm=function(){return w(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},m.prototype.redNeg=function(){return w(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},m.prototype.redPow=function(t){return w(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var A={k256:null,p224:null,p192:null,p25519:null};function B(g,t){this.name=g,this.p=new m(t,16),this.n=this.p.bitLength(),this.k=new m(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}B.prototype._tmp=function(){var t=new m(null);return t.words=new Array(Math.ceil(this.n/13)),t},B.prototype.ireduce=function(t){var n=t,h;do this.split(n,this.tmp),n=this.imulK(n),n=n.iadd(this.tmp),h=n.bitLength();while(h>this.n);var f=h<this.n?-1:n.ucmp(this.p);return f===0?(n.words[0]=0,n.length=1):f>0?n.isub(this.p):n.strip(),n},B.prototype.split=function(t,n){t.iushrn(this.n,0,n)},B.prototype.imulK=function(t){return t.imul(this.k)};function C(){B.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}b(C,B),C.prototype.split=function(t,n){for(var h=4194303,f=Math.min(t.length,9),d=0;d<f;d++)n.words[d]=t.words[d];if(n.length=f,t.length<=9){t.words[0]=0,t.length=1;return}var y=t.words[9];for(n.words[n.length++]=y&h,d=10;d<t.length;d++){var _=t.words[d]|0;t.words[d-10]=(_&h)<<4|y>>>22,y=_}y>>>=22,t.words[d-10]=y,y===0&&t.length>10?t.length-=10:t.length-=9},C.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var n=0,h=0;h<t.length;h++){var f=t.words[h]|0;n+=f*977,t.words[h]=n&67108863,n=f*64+(n/67108864|0)}return t.words[t.length-1]===0&&(t.length--,t.words[t.length-1]===0&&t.length--),t};function j(){B.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}b(j,B);function N(){B.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}b(N,B);function _t(){B.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}b(_t,B),_t.prototype.imulK=function(t){for(var n=0,h=0;h<t.length;h++){var f=(t.words[h]|0)*19+n,d=f&67108863;f>>>=26,t.words[h]=d,n=f}return n!==0&&(t.words[t.length++]=n),t},m._prime=function(t){if(A[t])return A[t];var n;if(t==="k256")n=new C;else if(t==="p224")n=new j;else if(t==="p192")n=new N;else if(t==="p25519")n=new _t;else throw new Error("Unknown prime "+t);return A[t]=n,n};function V(g){if(typeof g=="string"){var t=m._prime(g);this.m=t.p,this.prime=t}else w(g.gtn(1),"modulus must be greater than 1"),this.m=g,this.prime=null}V.prototype._verify1=function(t){w(t.negative===0,"red works only with positives"),w(t.red,"red works only with red numbers")},V.prototype._verify2=function(t,n){w((t.negative|n.negative)===0,"red works only with positives"),w(t.red&&t.red===n.red,"red works only with red numbers")},V.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},V.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},V.prototype.add=function(t,n){this._verify2(t,n);var h=t.add(n);return h.cmp(this.m)>=0&&h.isub(this.m),h._forceRed(this)},V.prototype.iadd=function(t,n){this._verify2(t,n);var h=t.iadd(n);return h.cmp(this.m)>=0&&h.isub(this.m),h},V.prototype.sub=function(t,n){this._verify2(t,n);var h=t.sub(n);return h.cmpn(0)<0&&h.iadd(this.m),h._forceRed(this)},V.prototype.isub=function(t,n){this._verify2(t,n);var h=t.isub(n);return h.cmpn(0)<0&&h.iadd(this.m),h},V.prototype.shl=function(t,n){return this._verify1(t),this.imod(t.ushln(n))},V.prototype.imul=function(t,n){return this._verify2(t,n),this.imod(t.imul(n))},V.prototype.mul=function(t,n){return this._verify2(t,n),this.imod(t.mul(n))},V.prototype.isqr=function(t){return this.imul(t,t.clone())},V.prototype.sqr=function(t){return this.mul(t,t)},V.prototype.sqrt=function(t){if(t.isZero())return t.clone();var n=this.m.andln(3);if(w(n%2===1),n===3){var h=this.m.add(new m(1)).iushrn(2);return this.pow(t,h)}for(var f=this.m.subn(1),d=0;!f.isZero()&&f.andln(1)===0;)d++,f.iushrn(1);w(!f.isZero());var y=new m(1).toRed(this),_=y.redNeg(),c=this.m.subn(1).iushrn(1),i=this.m.bitLength();for(i=new m(2*i*i).toRed(this);this.pow(i,c).cmp(_)!==0;)i.redIAdd(_);for(var l=this.pow(i,f),R=this.pow(t,f.addn(1).iushrn(1)),k=this.pow(t,f),T=d;k.cmp(y)!==0;){for(var O=k,D=0;O.cmp(y)!==0;D++)O=O.redSqr();w(D<T);var Z=this.pow(l,new m(1).iushln(T-D-1));R=R.redMul(Z),l=Z.redSqr(),k=k.redMul(l),T=D}return R},V.prototype.invm=function(t){var n=t._invmp(this.m);return n.negative!==0?(n.negative=0,this.imod(n).redNeg()):this.imod(n)},V.prototype.pow=function(t,n){if(n.isZero())return new m(1).toRed(this);if(n.cmpn(1)===0)return t.clone();var h=4,f=new Array(1<<h);f[0]=new m(1).toRed(this),f[1]=t;for(var d=2;d<f.length;d++)f[d]=this.mul(f[d-1],t);var y=f[0],_=0,c=0,i=n.bitLength()%26;for(i===0&&(i=26),d=n.length-1;d>=0;d--){for(var l=n.words[d],R=i-1;R>=0;R--){var k=l>>R&1;if(y!==f[0]&&(y=this.sqr(y)),k===0&&_===0){c=0;continue}_<<=1,_|=k,c++,!(c!==h&&(d!==0||R!==0))&&(y=this.mul(y,f[_]),c=0,_=0)}i=26}return y},V.prototype.convertTo=function(t){var n=t.umod(this.m);return n===t?n.clone():n},V.prototype.convertFrom=function(t){var n=t.clone();return n.red=null,n},m.mont=function(t){return new kt(t)};function kt(g){V.call(this,g),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new m(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b(kt,V),kt.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},kt.prototype.convertFrom=function(t){var n=this.imod(t.mul(this.rinv));return n.red=null,n},kt.prototype.imul=function(t,n){if(t.isZero()||n.isZero())return t.words[0]=0,t.length=1,t;var h=t.imul(n),f=h.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),d=h.isub(f).iushrn(this.shift),y=d;return d.cmp(this.m)>=0?y=d.isub(this.m):d.cmpn(0)<0&&(y=d.iadd(this.m)),y._forceRed(this)},kt.prototype.mul=function(t,n){if(t.isZero()||n.isZero())return new m(0)._forceRed(this);var h=t.mul(n),f=h.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),d=h.isub(f).iushrn(this.shift),y=d;return d.cmp(this.m)>=0?y=d.isub(this.m):d.cmpn(0)<0&&(y=d.iadd(this.m)),y._forceRed(this)},kt.prototype.invm=function(t){var n=this.imod(t._invmp(this.m).mul(this.r2));return n._forceRed(this)}})(u,dr)})(Me);var Mr=Me.exports;const _r=De(Mr);var Ht={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(u){const s=sr,p=or,w=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;u.Buffer=x,u.SlowBuffer=A,u.INSPECT_MAX_BYTES=50;const b=2147483647;u.kMaxLength=b,x.TYPED_ARRAY_SUPPORT=m(),!x.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function m(){try{const o=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(o,e),o.foo()===42}catch{return!1}}Object.defineProperty(x.prototype,"parent",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.buffer}}),Object.defineProperty(x.prototype,"offset",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.byteOffset}});function P(o){if(o>b)throw new RangeError('The value "'+o+'" is invalid for option "size"');const e=new Uint8Array(o);return Object.setPrototypeOf(e,x.prototype),e}function x(o,e,r){if(typeof o=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return It(o)}return $(o,e,r)}x.poolSize=8192;function $(o,e,r){if(typeof o=="string")return Et(o,e);if(ArrayBuffer.isView(o))return Tt(o);if(o==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o);if(bt(o,ArrayBuffer)||o&&bt(o.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(bt(o,SharedArrayBuffer)||o&&bt(o.buffer,SharedArrayBuffer)))return Ut(o,e,r);if(typeof o=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const a=o.valueOf&&o.valueOf();if(a!=null&&a!==o)return x.from(a,e,r);const v=E(o);if(v)return v;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof o[Symbol.toPrimitive]=="function")return x.from(o[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o)}x.from=function(o,e,r){return $(o,e,r)},Object.setPrototypeOf(x.prototype,Uint8Array.prototype),Object.setPrototypeOf(x,Uint8Array);function Mt(o){if(typeof o!="number")throw new TypeError('"size" argument must be of type number');if(o<0)throw new RangeError('The value "'+o+'" is invalid for option "size"')}function Bt(o,e,r){return Mt(o),o<=0?P(o):e!==void 0?typeof r=="string"?P(o).fill(e,r):P(o).fill(e):P(o)}x.alloc=function(o,e,r){return Bt(o,e,r)};function It(o){return Mt(o),P(o<0?0:S(o)|0)}x.allocUnsafe=function(o){return It(o)},x.allocUnsafeSlow=function(o){return It(o)};function Et(o,e){if((typeof e!="string"||e==="")&&(e="utf8"),!x.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=B(o,e)|0;let a=P(r);const v=a.write(o,e);return v!==r&&(a=a.slice(0,v)),a}function xt(o){const e=o.length<0?0:S(o.length)|0,r=P(e);for(let a=0;a<e;a+=1)r[a]=o[a]&255;return r}function Tt(o){if(bt(o,Uint8Array)){const e=new Uint8Array(o);return Ut(e.buffer,e.byteOffset,e.byteLength)}return xt(o)}function Ut(o,e,r){if(e<0||o.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(o.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let a;return e===void 0&&r===void 0?a=new Uint8Array(o):r===void 0?a=new Uint8Array(o,e):a=new Uint8Array(o,e,r),Object.setPrototypeOf(a,x.prototype),a}function E(o){if(x.isBuffer(o)){const e=S(o.length)|0,r=P(e);return r.length===0||o.copy(r,0,0,e),r}if(o.length!==void 0)return typeof o.length!="number"||Q(o.length)?P(0):xt(o);if(o.type==="Buffer"&&Array.isArray(o.data))return xt(o.data)}function S(o){if(o>=b)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+b.toString(16)+" bytes");return o|0}function A(o){return+o!=o&&(o=0),x.alloc(+o)}x.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==x.prototype},x.compare=function(e,r){if(bt(e,Uint8Array)&&(e=x.from(e,e.offset,e.byteLength)),bt(r,Uint8Array)&&(r=x.from(r,r.offset,r.byteLength)),!x.isBuffer(e)||!x.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let a=e.length,v=r.length;for(let M=0,I=Math.min(a,v);M<I;++M)if(e[M]!==r[M]){a=e[M],v=r[M];break}return a<v?-1:v<a?1:0},x.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},x.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return x.alloc(0);let a;if(r===void 0)for(r=0,a=0;a<e.length;++a)r+=e[a].length;const v=x.allocUnsafe(r);let M=0;for(a=0;a<e.length;++a){let I=e[a];if(bt(I,Uint8Array))M+I.length>v.length?(x.isBuffer(I)||(I=x.from(I)),I.copy(v,M)):Uint8Array.prototype.set.call(v,I,M);else if(x.isBuffer(I))I.copy(v,M);else throw new TypeError('"list" argument must be an Array of Buffers');M+=I.length}return v};function B(o,e){if(x.isBuffer(o))return o.length;if(ArrayBuffer.isView(o)||bt(o,ArrayBuffer))return o.byteLength;if(typeof o!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof o);const r=o.length,a=arguments.length>2&&arguments[2]===!0;if(!a&&r===0)return 0;let v=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return K(o).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return X(o).length;default:if(v)return a?-1:K(o).length;e=(""+e).toLowerCase(),v=!0}}x.byteLength=B;function C(o,e,r){let a=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(o||(o="utf8");;)switch(o){case"hex":return i(this,e,r);case"utf8":case"utf-8":return f(this,e,r);case"ascii":return _(this,e,r);case"latin1":case"binary":return c(this,e,r);case"base64":return h(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return l(this,e,r);default:if(a)throw new TypeError("Unknown encoding: "+o);o=(o+"").toLowerCase(),a=!0}}x.prototype._isBuffer=!0;function j(o,e,r){const a=o[e];o[e]=o[r],o[r]=a}x.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)j(this,r,r+1);return this},x.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)j(this,r,r+3),j(this,r+1,r+2);return this},x.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)j(this,r,r+7),j(this,r+1,r+6),j(this,r+2,r+5),j(this,r+3,r+4);return this},x.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?f(this,0,e):C.apply(this,arguments)},x.prototype.toLocaleString=x.prototype.toString,x.prototype.equals=function(e){if(!x.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:x.compare(this,e)===0},x.prototype.inspect=function(){let e="";const r=u.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},w&&(x.prototype[w]=x.prototype.inspect),x.prototype.compare=function(e,r,a,v,M){if(bt(e,Uint8Array)&&(e=x.from(e,e.offset,e.byteLength)),!x.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),a===void 0&&(a=e?e.length:0),v===void 0&&(v=0),M===void 0&&(M=this.length),r<0||a>e.length||v<0||M>this.length)throw new RangeError("out of range index");if(v>=M&&r>=a)return 0;if(v>=M)return-1;if(r>=a)return 1;if(r>>>=0,a>>>=0,v>>>=0,M>>>=0,this===e)return 0;let I=M-v,L=a-r;const q=Math.min(I,L),F=this.slice(v,M),z=e.slice(r,a);for(let U=0;U<q;++U)if(F[U]!==z[U]){I=F[U],L=z[U];break}return I<L?-1:L<I?1:0};function N(o,e,r,a,v){if(o.length===0)return-1;if(typeof r=="string"?(a=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,Q(r)&&(r=v?0:o.length-1),r<0&&(r=o.length+r),r>=o.length){if(v)return-1;r=o.length-1}else if(r<0)if(v)r=0;else return-1;if(typeof e=="string"&&(e=x.from(e,a)),x.isBuffer(e))return e.length===0?-1:_t(o,e,r,a,v);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?v?Uint8Array.prototype.indexOf.call(o,e,r):Uint8Array.prototype.lastIndexOf.call(o,e,r):_t(o,[e],r,a,v);throw new TypeError("val must be string, number or Buffer")}function _t(o,e,r,a,v){let M=1,I=o.length,L=e.length;if(a!==void 0&&(a=String(a).toLowerCase(),a==="ucs2"||a==="ucs-2"||a==="utf16le"||a==="utf-16le")){if(o.length<2||e.length<2)return-1;M=2,I/=2,L/=2,r/=2}function q(z,U){return M===1?z[U]:z.readUInt16BE(U*M)}let F;if(v){let z=-1;for(F=r;F<I;F++)if(q(o,F)===q(e,z===-1?0:F-z)){if(z===-1&&(z=F),F-z+1===L)return z*M}else z!==-1&&(F-=F-z),z=-1}else for(r+L>I&&(r=I-L),F=r;F>=0;F--){let z=!0;for(let U=0;U<L;U++)if(q(o,F+U)!==q(e,U)){z=!1;break}if(z)return F}return-1}x.prototype.includes=function(e,r,a){return this.indexOf(e,r,a)!==-1},x.prototype.indexOf=function(e,r,a){return N(this,e,r,a,!0)},x.prototype.lastIndexOf=function(e,r,a){return N(this,e,r,a,!1)};function V(o,e,r,a){r=Number(r)||0;const v=o.length-r;a?(a=Number(a),a>v&&(a=v)):a=v;const M=e.length;a>M/2&&(a=M/2);let I;for(I=0;I<a;++I){const L=parseInt(e.substr(I*2,2),16);if(Q(L))return I;o[r+I]=L}return I}function kt(o,e,r,a){return J(K(e,o.length-r),o,r,a)}function g(o,e,r,a){return J(rt(e),o,r,a)}function t(o,e,r,a){return J(X(e),o,r,a)}function n(o,e,r,a){return J(Wt(e,o.length-r),o,r,a)}x.prototype.write=function(e,r,a,v){if(r===void 0)v="utf8",a=this.length,r=0;else if(a===void 0&&typeof r=="string")v=r,a=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(a)?(a=a>>>0,v===void 0&&(v="utf8")):(v=a,a=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const M=this.length-r;if((a===void 0||a>M)&&(a=M),e.length>0&&(a<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");v||(v="utf8");let I=!1;for(;;)switch(v){case"hex":return V(this,e,r,a);case"utf8":case"utf-8":return kt(this,e,r,a);case"ascii":case"latin1":case"binary":return g(this,e,r,a);case"base64":return t(this,e,r,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n(this,e,r,a);default:if(I)throw new TypeError("Unknown encoding: "+v);v=(""+v).toLowerCase(),I=!0}},x.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function h(o,e,r){return e===0&&r===o.length?s.fromByteArray(o):s.fromByteArray(o.slice(e,r))}function f(o,e,r){r=Math.min(o.length,r);const a=[];let v=e;for(;v<r;){const M=o[v];let I=null,L=M>239?4:M>223?3:M>191?2:1;if(v+L<=r){let q,F,z,U;switch(L){case 1:M<128&&(I=M);break;case 2:q=o[v+1],(q&192)===128&&(U=(M&31)<<6|q&63,U>127&&(I=U));break;case 3:q=o[v+1],F=o[v+2],(q&192)===128&&(F&192)===128&&(U=(M&15)<<12|(q&63)<<6|F&63,U>2047&&(U<55296||U>57343)&&(I=U));break;case 4:q=o[v+1],F=o[v+2],z=o[v+3],(q&192)===128&&(F&192)===128&&(z&192)===128&&(U=(M&15)<<18|(q&63)<<12|(F&63)<<6|z&63,U>65535&&U<1114112&&(I=U))}}I===null?(I=65533,L=1):I>65535&&(I-=65536,a.push(I>>>10&1023|55296),I=56320|I&1023),a.push(I),v+=L}return y(a)}const d=4096;function y(o){const e=o.length;if(e<=d)return String.fromCharCode.apply(String,o);let r="",a=0;for(;a<e;)r+=String.fromCharCode.apply(String,o.slice(a,a+=d));return r}function _(o,e,r){let a="";r=Math.min(o.length,r);for(let v=e;v<r;++v)a+=String.fromCharCode(o[v]&127);return a}function c(o,e,r){let a="";r=Math.min(o.length,r);for(let v=e;v<r;++v)a+=String.fromCharCode(o[v]);return a}function i(o,e,r){const a=o.length;(!e||e<0)&&(e=0),(!r||r<0||r>a)&&(r=a);let v="";for(let M=e;M<r;++M)v+=it[o[M]];return v}function l(o,e,r){const a=o.slice(e,r);let v="";for(let M=0;M<a.length-1;M+=2)v+=String.fromCharCode(a[M]+a[M+1]*256);return v}x.prototype.slice=function(e,r){const a=this.length;e=~~e,r=r===void 0?a:~~r,e<0?(e+=a,e<0&&(e=0)):e>a&&(e=a),r<0?(r+=a,r<0&&(r=0)):r>a&&(r=a),r<e&&(r=e);const v=this.subarray(e,r);return Object.setPrototypeOf(v,x.prototype),v};function R(o,e,r){if(o%1!==0||o<0)throw new RangeError("offset is not uint");if(o+e>r)throw new RangeError("Trying to access beyond buffer length")}x.prototype.readUintLE=x.prototype.readUIntLE=function(e,r,a){e=e>>>0,r=r>>>0,a||R(e,r,this.length);let v=this[e],M=1,I=0;for(;++I<r&&(M*=256);)v+=this[e+I]*M;return v},x.prototype.readUintBE=x.prototype.readUIntBE=function(e,r,a){e=e>>>0,r=r>>>0,a||R(e,r,this.length);let v=this[e+--r],M=1;for(;r>0&&(M*=256);)v+=this[e+--r]*M;return v},x.prototype.readUint8=x.prototype.readUInt8=function(e,r){return e=e>>>0,r||R(e,1,this.length),this[e]},x.prototype.readUint16LE=x.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||R(e,2,this.length),this[e]|this[e+1]<<8},x.prototype.readUint16BE=x.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||R(e,2,this.length),this[e]<<8|this[e+1]},x.prototype.readUint32LE=x.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},x.prototype.readUint32BE=x.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||R(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},x.prototype.readBigUInt64LE=Rt(function(e){e=e>>>0,At(e,"offset");const r=this[e],a=this[e+7];(r===void 0||a===void 0)&&G(e,this.length-8);const v=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,M=this[++e]+this[++e]*2**8+this[++e]*2**16+a*2**24;return BigInt(v)+(BigInt(M)<<BigInt(32))}),x.prototype.readBigUInt64BE=Rt(function(e){e=e>>>0,At(e,"offset");const r=this[e],a=this[e+7];(r===void 0||a===void 0)&&G(e,this.length-8);const v=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],M=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+a;return(BigInt(v)<<BigInt(32))+BigInt(M)}),x.prototype.readIntLE=function(e,r,a){e=e>>>0,r=r>>>0,a||R(e,r,this.length);let v=this[e],M=1,I=0;for(;++I<r&&(M*=256);)v+=this[e+I]*M;return M*=128,v>=M&&(v-=Math.pow(2,8*r)),v},x.prototype.readIntBE=function(e,r,a){e=e>>>0,r=r>>>0,a||R(e,r,this.length);let v=r,M=1,I=this[e+--v];for(;v>0&&(M*=256);)I+=this[e+--v]*M;return M*=128,I>=M&&(I-=Math.pow(2,8*r)),I},x.prototype.readInt8=function(e,r){return e=e>>>0,r||R(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},x.prototype.readInt16LE=function(e,r){e=e>>>0,r||R(e,2,this.length);const a=this[e]|this[e+1]<<8;return a&32768?a|4294901760:a},x.prototype.readInt16BE=function(e,r){e=e>>>0,r||R(e,2,this.length);const a=this[e+1]|this[e]<<8;return a&32768?a|4294901760:a},x.prototype.readInt32LE=function(e,r){return e=e>>>0,r||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},x.prototype.readInt32BE=function(e,r){return e=e>>>0,r||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},x.prototype.readBigInt64LE=Rt(function(e){e=e>>>0,At(e,"offset");const r=this[e],a=this[e+7];(r===void 0||a===void 0)&&G(e,this.length-8);const v=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(a<<24);return(BigInt(v)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)}),x.prototype.readBigInt64BE=Rt(function(e){e=e>>>0,At(e,"offset");const r=this[e],a=this[e+7];(r===void 0||a===void 0)&&G(e,this.length-8);const v=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(v)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+a)}),x.prototype.readFloatLE=function(e,r){return e=e>>>0,r||R(e,4,this.length),p.read(this,e,!0,23,4)},x.prototype.readFloatBE=function(e,r){return e=e>>>0,r||R(e,4,this.length),p.read(this,e,!1,23,4)},x.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||R(e,8,this.length),p.read(this,e,!0,52,8)},x.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||R(e,8,this.length),p.read(this,e,!1,52,8)};function k(o,e,r,a,v,M){if(!x.isBuffer(o))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>v||e<M)throw new RangeError('"value" argument is out of bounds');if(r+a>o.length)throw new RangeError("Index out of range")}x.prototype.writeUintLE=x.prototype.writeUIntLE=function(e,r,a,v){if(e=+e,r=r>>>0,a=a>>>0,!v){const L=Math.pow(2,8*a)-1;k(this,e,r,a,L,0)}let M=1,I=0;for(this[r]=e&255;++I<a&&(M*=256);)this[r+I]=e/M&255;return r+a},x.prototype.writeUintBE=x.prototype.writeUIntBE=function(e,r,a,v){if(e=+e,r=r>>>0,a=a>>>0,!v){const L=Math.pow(2,8*a)-1;k(this,e,r,a,L,0)}let M=a-1,I=1;for(this[r+M]=e&255;--M>=0&&(I*=256);)this[r+M]=e/I&255;return r+a},x.prototype.writeUint8=x.prototype.writeUInt8=function(e,r,a){return e=+e,r=r>>>0,a||k(this,e,r,1,255,0),this[r]=e&255,r+1},x.prototype.writeUint16LE=x.prototype.writeUInt16LE=function(e,r,a){return e=+e,r=r>>>0,a||k(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2},x.prototype.writeUint16BE=x.prototype.writeUInt16BE=function(e,r,a){return e=+e,r=r>>>0,a||k(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2},x.prototype.writeUint32LE=x.prototype.writeUInt32LE=function(e,r,a){return e=+e,r=r>>>0,a||k(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4},x.prototype.writeUint32BE=x.prototype.writeUInt32BE=function(e,r,a){return e=+e,r=r>>>0,a||k(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function T(o,e,r,a,v){Y(e,a,v,o,r,7);let M=Number(e&BigInt(4294967295));o[r++]=M,M=M>>8,o[r++]=M,M=M>>8,o[r++]=M,M=M>>8,o[r++]=M;let I=Number(e>>BigInt(32)&BigInt(4294967295));return o[r++]=I,I=I>>8,o[r++]=I,I=I>>8,o[r++]=I,I=I>>8,o[r++]=I,r}function O(o,e,r,a,v){Y(e,a,v,o,r,7);let M=Number(e&BigInt(4294967295));o[r+7]=M,M=M>>8,o[r+6]=M,M=M>>8,o[r+5]=M,M=M>>8,o[r+4]=M;let I=Number(e>>BigInt(32)&BigInt(4294967295));return o[r+3]=I,I=I>>8,o[r+2]=I,I=I>>8,o[r+1]=I,I=I>>8,o[r]=I,r+8}x.prototype.writeBigUInt64LE=Rt(function(e,r=0){return T(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))}),x.prototype.writeBigUInt64BE=Rt(function(e,r=0){return O(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))}),x.prototype.writeIntLE=function(e,r,a,v){if(e=+e,r=r>>>0,!v){const q=Math.pow(2,8*a-1);k(this,e,r,a,q-1,-q)}let M=0,I=1,L=0;for(this[r]=e&255;++M<a&&(I*=256);)e<0&&L===0&&this[r+M-1]!==0&&(L=1),this[r+M]=(e/I>>0)-L&255;return r+a},x.prototype.writeIntBE=function(e,r,a,v){if(e=+e,r=r>>>0,!v){const q=Math.pow(2,8*a-1);k(this,e,r,a,q-1,-q)}let M=a-1,I=1,L=0;for(this[r+M]=e&255;--M>=0&&(I*=256);)e<0&&L===0&&this[r+M+1]!==0&&(L=1),this[r+M]=(e/I>>0)-L&255;return r+a},x.prototype.writeInt8=function(e,r,a){return e=+e,r=r>>>0,a||k(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1},x.prototype.writeInt16LE=function(e,r,a){return e=+e,r=r>>>0,a||k(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2},x.prototype.writeInt16BE=function(e,r,a){return e=+e,r=r>>>0,a||k(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2},x.prototype.writeInt32LE=function(e,r,a){return e=+e,r=r>>>0,a||k(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4},x.prototype.writeInt32BE=function(e,r,a){return e=+e,r=r>>>0,a||k(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4},x.prototype.writeBigInt64LE=Rt(function(e,r=0){return T(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),x.prototype.writeBigInt64BE=Rt(function(e,r=0){return O(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function D(o,e,r,a,v,M){if(r+a>o.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Z(o,e,r,a,v){return e=+e,r=r>>>0,v||D(o,e,r,4),p.write(o,e,r,a,23,4),r+4}x.prototype.writeFloatLE=function(e,r,a){return Z(this,e,r,!0,a)},x.prototype.writeFloatBE=function(e,r,a){return Z(this,e,r,!1,a)};function St(o,e,r,a,v){return e=+e,r=r>>>0,v||D(o,e,r,8),p.write(o,e,r,a,52,8),r+8}x.prototype.writeDoubleLE=function(e,r,a){return St(this,e,r,!0,a)},x.prototype.writeDoubleBE=function(e,r,a){return St(this,e,r,!1,a)},x.prototype.copy=function(e,r,a,v){if(!x.isBuffer(e))throw new TypeError("argument should be a Buffer");if(a||(a=0),!v&&v!==0&&(v=this.length),r>=e.length&&(r=e.length),r||(r=0),v>0&&v<a&&(v=a),v===a||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(a<0||a>=this.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("sourceEnd out of bounds");v>this.length&&(v=this.length),e.length-r<v-a&&(v=e.length-r+a);const M=v-a;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,a,v):Uint8Array.prototype.set.call(e,this.subarray(a,v),r),M},x.prototype.fill=function(e,r,a,v){if(typeof e=="string"){if(typeof r=="string"?(v=r,r=0,a=this.length):typeof a=="string"&&(v=a,a=this.length),v!==void 0&&typeof v!="string")throw new TypeError("encoding must be a string");if(typeof v=="string"&&!x.isEncoding(v))throw new TypeError("Unknown encoding: "+v);if(e.length===1){const I=e.charCodeAt(0);(v==="utf8"&&I<128||v==="latin1")&&(e=I)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<a)throw new RangeError("Out of range index");if(a<=r)return this;r=r>>>0,a=a===void 0?this.length:a>>>0,e||(e=0);let M;if(typeof e=="number")for(M=r;M<a;++M)this[M]=e;else{const I=x.isBuffer(e)?e:x.from(e,v),L=I.length;if(L===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(M=0;M<a-r;++M)this[M+r]=I[M%L]}return this};const H={};function W(o,e,r){H[o]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${o}]`,this.stack,delete this.name}get code(){return o}set code(v){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:v,writable:!0})}toString(){return`${this.name} [${o}]: ${this.message}`}}}W("ERR_BUFFER_OUT_OF_BOUNDS",function(o){return o?`${o} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),W("ERR_INVALID_ARG_TYPE",function(o,e){return`The "${o}" argument must be of type number. Received type ${typeof e}`},TypeError),W("ERR_OUT_OF_RANGE",function(o,e,r){let a=`The value of "${o}" is out of range.`,v=r;return Number.isInteger(r)&&Math.abs(r)>2**32?v=$t(String(r)):typeof r=="bigint"&&(v=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(v=$t(v)),v+="n"),a+=` It must be ${e}. Received ${v}`,a},RangeError);function $t(o){let e="",r=o.length;const a=o[0]==="-"?1:0;for(;r>=a+4;r-=3)e=`_${o.slice(r-3,r)}${e}`;return`${o.slice(0,r)}${e}`}function tt(o,e,r){At(e,"offset"),(o[e]===void 0||o[e+r]===void 0)&&G(e,o.length-(r+1))}function Y(o,e,r,a,v,M){if(o>r||o<e){const I=typeof e=="bigint"?"n":"";let L;throw M>3?e===0||e===BigInt(0)?L=`>= 0${I} and < 2${I} ** ${(M+1)*8}${I}`:L=`>= -(2${I} ** ${(M+1)*8-1}${I}) and < 2 ** ${(M+1)*8-1}${I}`:L=`>= ${e}${I} and <= ${r}${I}`,new H.ERR_OUT_OF_RANGE("value",L,o)}tt(a,v,M)}function At(o,e){if(typeof o!="number")throw new H.ERR_INVALID_ARG_TYPE(e,"number",o)}function G(o,e,r){throw Math.floor(o)!==o?(At(o,r),new H.ERR_OUT_OF_RANGE(r||"offset","an integer",o)):e<0?new H.ERR_BUFFER_OUT_OF_BOUNDS:new H.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,o)}const et=/[^+/0-9A-Za-z-_]/g;function Zt(o){if(o=o.split("=")[0],o=o.trim().replace(et,""),o.length<2)return"";for(;o.length%4!==0;)o=o+"=";return o}function K(o,e){e=e||1/0;let r;const a=o.length;let v=null;const M=[];for(let I=0;I<a;++I){if(r=o.charCodeAt(I),r>55295&&r<57344){if(!v){if(r>56319){(e-=3)>-1&&M.push(239,191,189);continue}else if(I+1===a){(e-=3)>-1&&M.push(239,191,189);continue}v=r;continue}if(r<56320){(e-=3)>-1&&M.push(239,191,189),v=r;continue}r=(v-55296<<10|r-56320)+65536}else v&&(e-=3)>-1&&M.push(239,191,189);if(v=null,r<128){if((e-=1)<0)break;M.push(r)}else if(r<2048){if((e-=2)<0)break;M.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;M.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;M.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return M}function rt(o){const e=[];for(let r=0;r<o.length;++r)e.push(o.charCodeAt(r)&255);return e}function Wt(o,e){let r,a,v;const M=[];for(let I=0;I<o.length&&!((e-=2)<0);++I)r=o.charCodeAt(I),a=r>>8,v=r%256,M.push(v),M.push(a);return M}function X(o){return s.toByteArray(Zt(o))}function J(o,e,r,a){let v;for(v=0;v<a&&!(v+r>=e.length||v>=o.length);++v)e[v+r]=o[v];return v}function bt(o,e){return o instanceof e||o!=null&&o.constructor!=null&&o.constructor.name!=null&&o.constructor.name===e.name}function Q(o){return o!==o}const it=function(){const o="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const a=r*16;for(let v=0;v<16;++v)e[a+v]=o[r]+o[v]}return e}();function Rt(o){return typeof BigInt>"u"?nt:o}function nt(){throw new Error("BigInt not supported")}})(Ht);var xr=_e;_e.strict=je;_e.loose=Ze;var Ir=Object.prototype.toString,br={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function _e(u){return je(u)||Ze(u)}function je(u){return u instanceof Int8Array||u instanceof Int16Array||u instanceof Int32Array||u instanceof Uint8Array||u instanceof Uint8ClampedArray||u instanceof Uint16Array||u instanceof Uint32Array||u instanceof Float32Array||u instanceof Float64Array}function Ze(u){return br[Ir.call(u)]}var Er=xr.strict,Sr=function(s){if(Er(s)){var p=Ht.Buffer.from(s.buffer);return s.byteLength!==s.buffer.byteLength&&(p=p.slice(s.byteOffset,s.byteOffset+s.byteLength)),p}else return Ht.Buffer.from(s)};const Rr=De(Sr),We="hex",Ge="utf8",zt="0";function Lt(u){return new Uint8Array(u)}function Je(u,s=!1){const p=u.toString(We);return s?Pt(p):p}function Br(u){return u.toString(Ge)}function Kt(u){return Rr(u)}function Ct(u,s=!1){return Je(Kt(u),s)}function kr(u){return Br(Kt(u))}function Ar(u){return Ht.Buffer.from(Ft(u),We)}function Nt(u){return Lt(Ar(u))}function xe(u){return Ht.Buffer.from(u,Ge)}function Tr(u){return Lt(xe(u))}function Ur(u,s=!1){return Je(xe(u),s)}function Fr(u,s){return!(typeof u!="string"||!u.match(/^0x[0-9A-Fa-f]*$/)||s&&u.length!==2+2*s)}function ze(...u){let s=[];return u.forEach(p=>s=s.concat(Array.from(p))),new Uint8Array([...s])}function Or(u,s=8){const p=u%s;return p?(u-p)/s*s+s:u}function qr(u,s=8,p=zt){return Cr(u,Or(u.length,s),p)}function Cr(u,s,p=zt){return Lr(u,s,!0,p)}function Ft(u){return u.replace(/^0x/,"")}function Pt(u){return u.startsWith("0x")?u:`0x${u}`}function Ke(u){return u=Ft(u),u=qr(u,2),u&&(u=Pt(u)),u}function Nr(u){const s=u.startsWith("0x");return u=Ft(u),u=u.startsWith(zt)?u.substring(1):u,s?Pt(u):u}function Lr(u,s,p,w=zt){const b=s-u.length;let m=u;if(b>0){const P=w.repeat(b);m=p?P+u:u+P}return m}function we(u){return Kt(new Uint8Array(u))}function Pr(u,s){return Ct(new Uint8Array(u),!s)}function $r(u){return Lt(u).buffer}function Dr(u){return xe(u)}function Hr(u,s){return Ur(u,!s)}function jr(u){return Nt(u).buffer}function Qe(u,s){const p=Ft(Ke(new _r(u).toString(16)));return s?p:Pt(p)}function Gt(u){return Ke(u)}function Zr(u){return Nr(Pt(u))}const Wr=pr;function me(){return((s,p)=>{for(p=s="";s++<36;p+=s*51&52?(s^15?8^Math.random()*(s^20?16:4):4).toString(16):"-");return p})()}function Gr(u){return u===""||typeof u=="string"&&u.trim()===""}function Jr(u){return!(u&&u.length)}function Ve(u,s){return Fr(u,s)}function zr(u){return typeof u.method<"u"}function Dt(u){return typeof u.result<"u"}function Jt(u){return typeof u.error<"u"}function qe(u){return typeof u.event<"u"}function Kr(u){return vr.includes(u)||u.startsWith("wc_")}function Qr(u){return u.method.startsWith("wc_")?!0:!He.includes(u.method)}function Vr(u){u=Ft(u.toLowerCase());const s=Ft(mr.keccak_256(Dr(u)));let p="";for(let w=0;w<u.length;w++)parseInt(s[w],16)>7?p+=u[w].toUpperCase():p+=u[w];return Pt(p)}const Yr=u=>u?u.toLowerCase().substring(0,2)!=="0x"?!1:/^(0x)?[0-9a-f]{40}$/i.test(u)?/^(0x)?[0-9a-f]{40}$/.test(u)||/^(0x)?[0-9A-F]{40}$/.test(u)?!0:u===Vr(u):!1:!1;function Ce(u){return!Jr(u)&&!Ve(u[0])&&(u[0]=Hr(u[0])),u}function ge(u){if(typeof u.type<"u"&&u.type!=="0")return u;if(typeof u.from>"u"||!Yr(u.from))throw new Error("Transaction object must include a valid 'from' value.");function s(b){let m=b;return(typeof b=="number"||typeof b=="string"&&!Gr(b))&&(Ve(b)?typeof b=="string"&&(m=Gt(b)):m=Qe(b)),typeof m=="string"&&(m=Zr(m)),m}const p={from:Gt(u.from),to:typeof u.to>"u"?void 0:Gt(u.to),gasPrice:typeof u.gasPrice>"u"?"":s(u.gasPrice),gas:typeof u.gas>"u"?typeof u.gasLimit>"u"?"":s(u.gasLimit):s(u.gas),value:typeof u.value>"u"?"":s(u.value),nonce:typeof u.nonce>"u"?"":s(u.nonce),data:typeof u.data>"u"?"":Gt(u.data)||"0x"},w=["gasPrice","gas","value","nonce"];return Object.keys(p).forEach(b=>{(typeof p[b]>"u"||typeof p[b]=="string"&&!p[b].trim().length)&&w.includes(b)&&delete p[b]}),p}function Xr(u){const s=u.message||"Failed or Rejected Request";let p=-32e3;if(u&&!u.code)switch(s){case"Parse error":p=-32700;break;case"Invalid request":p=-32600;break;case"Method not found":p=-32601;break;case"Invalid params":p=-32602;break;case"Internal error":p=-32603;break;default:p=-32e3;break}const w={code:p,message:s};return u.data&&(w.data=u.data),w}var Ie={};(function(u){const s=yr,p=wr,w=gr,b=E=>E==null;function m(E){switch(E.arrayFormat){case"index":return S=>(A,B)=>{const C=A.length;return B===void 0||E.skipNull&&B===null||E.skipEmptyString&&B===""?A:B===null?[...A,[$(S,E),"[",C,"]"].join("")]:[...A,[$(S,E),"[",$(C,E),"]=",$(B,E)].join("")]};case"bracket":return S=>(A,B)=>B===void 0||E.skipNull&&B===null||E.skipEmptyString&&B===""?A:B===null?[...A,[$(S,E),"[]"].join("")]:[...A,[$(S,E),"[]=",$(B,E)].join("")];case"comma":case"separator":return S=>(A,B)=>B==null||B.length===0?A:A.length===0?[[$(S,E),"=",$(B,E)].join("")]:[[A,$(B,E)].join(E.arrayFormatSeparator)];default:return S=>(A,B)=>B===void 0||E.skipNull&&B===null||E.skipEmptyString&&B===""?A:B===null?[...A,$(S,E)]:[...A,[$(S,E),"=",$(B,E)].join("")]}}function P(E){let S;switch(E.arrayFormat){case"index":return(A,B,C)=>{if(S=/\[(\d*)\]$/.exec(A),A=A.replace(/\[\d*\]$/,""),!S){C[A]=B;return}C[A]===void 0&&(C[A]={}),C[A][S[1]]=B};case"bracket":return(A,B,C)=>{if(S=/(\[\])$/.exec(A),A=A.replace(/\[\]$/,""),!S){C[A]=B;return}if(C[A]===void 0){C[A]=[B];return}C[A]=[].concat(C[A],B)};case"comma":case"separator":return(A,B,C)=>{const N=typeof B=="string"&&B.split("").indexOf(E.arrayFormatSeparator)>-1?B.split(E.arrayFormatSeparator).map(_t=>Mt(_t,E)):B===null?B:Mt(B,E);C[A]=N};default:return(A,B,C)=>{if(C[A]===void 0){C[A]=B;return}C[A]=[].concat(C[A],B)}}}function x(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function $(E,S){return S.encode?S.strict?s(E):encodeURIComponent(E):E}function Mt(E,S){return S.decode?p(E):E}function Bt(E){return Array.isArray(E)?E.sort():typeof E=="object"?Bt(Object.keys(E)).sort((S,A)=>Number(S)-Number(A)).map(S=>E[S]):E}function It(E){const S=E.indexOf("#");return S!==-1&&(E=E.slice(0,S)),E}function Et(E){let S="";const A=E.indexOf("#");return A!==-1&&(S=E.slice(A)),S}function xt(E){E=It(E);const S=E.indexOf("?");return S===-1?"":E.slice(S+1)}function Tt(E,S){return S.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):S.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function Ut(E,S){S=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},S),x(S.arrayFormatSeparator);const A=P(S),B=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return B;for(const C of E.split("&")){let[j,N]=w(S.decode?C.replace(/\+/g," "):C,"=");N=N===void 0?null:["comma","separator"].includes(S.arrayFormat)?N:Mt(N,S),A(Mt(j,S),N,B)}for(const C of Object.keys(B)){const j=B[C];if(typeof j=="object"&&j!==null)for(const N of Object.keys(j))j[N]=Tt(j[N],S);else B[C]=Tt(j,S)}return S.sort===!1?B:(S.sort===!0?Object.keys(B).sort():Object.keys(B).sort(S.sort)).reduce((C,j)=>{const N=B[j];return N&&typeof N=="object"&&!Array.isArray(N)?C[j]=Bt(N):C[j]=N,C},Object.create(null))}u.extract=xt,u.parse=Ut,u.stringify=(E,S)=>{if(!E)return"";S=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},S),x(S.arrayFormatSeparator);const A=N=>S.skipNull&&b(E[N])||S.skipEmptyString&&E[N]==="",B=m(S),C={};for(const N of Object.keys(E))A(N)||(C[N]=E[N]);const j=Object.keys(C);return S.sort!==!1&&j.sort(S.sort),j.map(N=>{const _t=E[N];return _t===void 0?"":_t===null?$(N,S):Array.isArray(_t)?_t.reduce(B(N),[]).join("&"):$(N,S)+"="+$(_t,S)}).filter(N=>N.length>0).join("&")},u.parseUrl=(E,S)=>{S=Object.assign({decode:!0},S);const[A,B]=w(E,"#");return Object.assign({url:A.split("?")[0]||"",query:Ut(xt(E),S)},S&&S.parseFragmentIdentifier&&B?{fragmentIdentifier:Mt(B,S)}:{})},u.stringifyUrl=(E,S)=>{S=Object.assign({encode:!0,strict:!0},S);const A=It(E.url).split("?")[0]||"",B=u.extract(E.url),C=u.parse(B,{sort:!1}),j=Object.assign(C,E.query);let N=u.stringify(j,S);N&&(N=`?${N}`);let _t=Et(E.url);return E.fragmentIdentifier&&(_t=`#${$(E.fragmentIdentifier,S)}`),`${A}${N}${_t}`}})(Ie);function ti(u){const s=u.indexOf("?")!==-1?u.indexOf("?"):void 0;return typeof s<"u"?u.substr(s):""}function ei(u,s){let p=Ye(u);return p=Object.assign(Object.assign({},p),s),u=ri(p),u}function Ye(u){return Ie.parse(u)}function ri(u){return Ie.stringify(u)}function ii(u){return typeof u.bridge<"u"}function ni(u){const s=u.indexOf(":"),p=u.indexOf("?")!==-1?u.indexOf("?"):void 0,w=u.substring(0,s),b=u.substring(s+1,p);function m(It){const Et="@",xt=It.split(Et);return{handshakeTopic:xt[0],version:parseInt(xt[1],10)}}const P=m(b),x=typeof p<"u"?u.substr(p):"";function $(It){const Et=Ye(It);return{key:Et.key||"",bridge:Et.bridge||""}}const Mt=$(x);return Object.assign(Object.assign({protocol:w},P),Mt)}class si{constructor(){this._eventEmitters=[],typeof window<"u"&&typeof window.addEventListener<"u"&&(window.addEventListener("online",()=>this.trigger("online")),window.addEventListener("offline",()=>this.trigger("offline")))}on(s,p){this._eventEmitters.push({event:s,callback:p})}trigger(s){let p=[];s&&(p=this._eventEmitters.filter(w=>w.event===s)),p.forEach(w=>{w.callback()})}}const oi=typeof Oe.WebSocket<"u"?Oe.WebSocket:require("ws");class hi{constructor(s){if(this.opts=s,this._queue=[],this._events=[],this._subscriptions=[],this._protocol=s.protocol,this._version=s.version,this._url="",this._netMonitor=null,this._socket=null,this._nextSocket=null,this._subscriptions=s.subscriptions||[],this._netMonitor=s.netMonitor||new si,!s.url||typeof s.url!="string")throw new Error("Missing or invalid WebSocket url");this._url=s.url,this._netMonitor.on("online",()=>this._socketCreate())}set readyState(s){}get readyState(){return this._socket?this._socket.readyState:-1}set connecting(s){}get connecting(){return this.readyState===0}set connected(s){}get connected(){return this.readyState===1}set closing(s){}get closing(){return this.readyState===2}set closed(s){}get closed(){return this.readyState===3}open(){this._socketCreate()}close(){this._socketClose()}send(s,p,w){if(!p||typeof p!="string")throw new Error("Missing or invalid topic field");this._socketSend({topic:p,type:"pub",payload:s,silent:!!w})}subscribe(s){this._socketSend({topic:s,type:"sub",payload:"",silent:!0})}on(s,p){this._events.push({event:s,callback:p})}_socketCreate(){if(this._nextSocket)return;const s=ai(this._url,this._protocol,this._version);if(this._nextSocket=new oi(s),!this._nextSocket)throw new Error("Failed to create socket");this._nextSocket.onmessage=p=>this._socketReceive(p),this._nextSocket.onopen=()=>this._socketOpen(),this._nextSocket.onerror=p=>this._socketError(p),this._nextSocket.onclose=()=>{setTimeout(()=>{this._nextSocket=null,this._socketCreate()},1e3)}}_socketOpen(){this._socketClose(),this._socket=this._nextSocket,this._nextSocket=null,this._queueSubscriptions(),this._pushQueue()}_socketClose(){this._socket&&(this._socket.onclose=()=>{},this._socket.close())}_socketSend(s){const p=JSON.stringify(s);this._socket&&this._socket.readyState===1?this._socket.send(p):(this._setToQueue(s),this._socketCreate())}async _socketReceive(s){let p;try{p=JSON.parse(s.data)}catch{return}if(this._socketSend({topic:p.topic,type:"ack",payload:"",silent:!0}),this._socket&&this._socket.readyState===1){const w=this._events.filter(b=>b.event==="message");w&&w.length&&w.forEach(b=>b.callback(p))}}_socketError(s){const p=this._events.filter(w=>w.event==="error");p&&p.length&&p.forEach(w=>w.callback(s))}_queueSubscriptions(){this._subscriptions.forEach(p=>this._queue.push({topic:p,type:"sub",payload:"",silent:!0})),this._subscriptions=this.opts.subscriptions||[]}_setToQueue(s){this._queue.push(s)}_pushQueue(){this._queue.forEach(p=>this._socketSend(p)),this._queue=[]}}function ai(u,s,p){var w,b;const P=(u.startsWith("https")?u.replace("https","wss"):u.startsWith("http")?u.replace("http","ws"):u).split("?"),x=hr()?{protocol:s,version:p,env:"browser",host:((w=ar())===null||w===void 0?void 0:w.host)||""}:{protocol:s,version:p,env:((b=fr())===null||b===void 0?void 0:b.name)||""},$=ei(ti(P[1]||""),x);return P[0]+"?"+$}const ye="Session currently connected",qt="Session currently disconnected",fi="Session Rejected",ui="Missing JSON RPC response",ci='JSON-RPC success response must include "result" field',li='JSON-RPC error response must include "error" field',di='JSON RPC request must have valid "method" value',pi='JSON RPC request must have valid "id" value',mi="Missing one of the required parameters: bridge / uri / session",Ne="JSON RPC response format is invalid",gi="URI format is invalid",yi="QRCode Modal not provided",Le="User close QRCode Modal";class wi{constructor(){this._eventEmitters=[]}subscribe(s){this._eventEmitters.push(s)}unsubscribe(s){this._eventEmitters=this._eventEmitters.filter(p=>p.event!==s)}trigger(s){let p=[],w;zr(s)?w=s.method:Dt(s)||Jt(s)?w=`response:${s.id}`:qe(s)?w=s.event:w="",w&&(p=this._eventEmitters.filter(b=>b.event===w)),(!p||!p.length)&&!Kr(w)&&!qe(w)&&(p=this._eventEmitters.filter(b=>b.event==="call_request")),p.forEach(b=>{if(Jt(s)){const m=new Error(s.error.message);b.callback(m,null)}else b.callback(null,s)})}}class vi{constructor(s="walletconnect"){this.storageId=s}getSession(){let s=null;const p=Pe(this.storageId);return p&&ii(p)&&(s=p),s}setSession(s){return ur(this.storageId,s),s}removeSession(){$e(this.storageId)}}const Mi="walletconnect.org",_i="abcdefghijklmnopqrstuvwxyz0123456789",Xe=_i.split("").map(u=>`https://${u}.bridge.walletconnect.org`);function xi(u){let s=u.indexOf("//")>-1?u.split("/")[2]:u.split("/")[0];return s=s.split(":")[0],s=s.split("?")[0],s}function Ii(u){return xi(u).split(".").slice(-2).join(".")}function bi(){return Math.floor(Math.random()*Xe.length)}function Ei(){return Xe[bi()]}function Si(u){return Ii(u)===Mi}function Ri(u){return Si(u)?Ei():u}class Bi{constructor(s){if(this.protocol="wc",this.version=1,this._bridge="",this._key=null,this._clientId="",this._clientMeta=null,this._peerId="",this._peerMeta=null,this._handshakeId=0,this._handshakeTopic="",this._connected=!1,this._accounts=[],this._chainId=0,this._networkId=0,this._rpcUrl="",this._eventManager=new wi,this._clientMeta=Ue()||s.connectorOpts.clientMeta||null,this._cryptoLib=s.cryptoLib,this._sessionStorage=s.sessionStorage||new vi(s.connectorOpts.storageId),this._qrcodeModal=s.connectorOpts.qrcodeModal,this._qrcodeModalOptions=s.connectorOpts.qrcodeModalOptions,this._signingMethods=[...He,...s.connectorOpts.signingMethods||[]],!s.connectorOpts.bridge&&!s.connectorOpts.uri&&!s.connectorOpts.session)throw new Error(mi);s.connectorOpts.bridge&&(this.bridge=Ri(s.connectorOpts.bridge)),s.connectorOpts.uri&&(this.uri=s.connectorOpts.uri);const p=s.connectorOpts.session||this._getStorageSession();p&&(this.session=p),this.handshakeId&&this._subscribeToSessionResponse(this.handshakeId,"Session request rejected"),this._transport=s.transport||new hi({protocol:this.protocol,version:this.version,url:this.bridge,subscriptions:[this.clientId]}),this._subscribeToInternalEvents(),this._initTransport(),s.connectorOpts.uri&&this._subscribeToSessionRequest(),s.pushServerOpts&&this._registerPushServer(s.pushServerOpts)}set bridge(s){s&&(this._bridge=s)}get bridge(){return this._bridge}set key(s){if(!s)return;const p=jr(s);this._key=p}get key(){return this._key?Pr(this._key,!0):""}set clientId(s){s&&(this._clientId=s)}get clientId(){let s=this._clientId;return s||(s=this._clientId=me()),this._clientId}set peerId(s){s&&(this._peerId=s)}get peerId(){return this._peerId}set clientMeta(s){}get clientMeta(){let s=this._clientMeta;return s||(s=this._clientMeta=Ue()),s}set peerMeta(s){this._peerMeta=s}get peerMeta(){return this._peerMeta}set handshakeTopic(s){s&&(this._handshakeTopic=s)}get handshakeTopic(){return this._handshakeTopic}set handshakeId(s){s&&(this._handshakeId=s)}get handshakeId(){return this._handshakeId}get uri(){return this._formatUri()}set uri(s){if(!s)return;const{handshakeTopic:p,bridge:w,key:b}=this._parseUri(s);this.handshakeTopic=p,this.bridge=w,this.key=b}set chainId(s){this._chainId=s}get chainId(){return this._chainId}set networkId(s){this._networkId=s}get networkId(){return this._networkId}set accounts(s){this._accounts=s}get accounts(){return this._accounts}set rpcUrl(s){this._rpcUrl=s}get rpcUrl(){return this._rpcUrl}set connected(s){}get connected(){return this._connected}set pending(s){}get pending(){return!!this._handshakeTopic}get session(){return{connected:this.connected,accounts:this.accounts,chainId:this.chainId,bridge:this.bridge,key:this.key,clientId:this.clientId,clientMeta:this.clientMeta,peerId:this.peerId,peerMeta:this.peerMeta,handshakeId:this.handshakeId,handshakeTopic:this.handshakeTopic}}set session(s){s&&(this._connected=s.connected,this.accounts=s.accounts,this.chainId=s.chainId,this.bridge=s.bridge,this.key=s.key,this.clientId=s.clientId,this.clientMeta=s.clientMeta,this.peerId=s.peerId,this.peerMeta=s.peerMeta,this.handshakeId=s.handshakeId,this.handshakeTopic=s.handshakeTopic)}on(s,p){const w={event:s,callback:p};this._eventManager.subscribe(w)}off(s){this._eventManager.unsubscribe(s)}async createInstantRequest(s){this._key=await this._generateKey();const p=this._formatRequest({method:"wc_instantRequest",params:[{peerId:this.clientId,peerMeta:this.clientMeta,request:this._formatRequest(s)}]});this.handshakeId=p.id,this.handshakeTopic=me(),this._eventManager.trigger({event:"display_uri",params:[this.uri]}),this.on("modal_closed",()=>{throw new Error(Le)});const w=()=>{this.killSession()};try{const b=await this._sendCallRequest(p);return b&&w(),b}catch(b){throw w(),b}}async connect(s){if(!this._qrcodeModal)throw new Error(yi);return this.connected?{chainId:this.chainId,accounts:this.accounts}:(await this.createSession(s),new Promise(async(p,w)=>{this.on("modal_closed",()=>w(new Error(Le))),this.on("connect",(b,m)=>{if(b)return w(b);p(m.params[0])})}))}async createSession(s){if(this._connected)throw new Error(ye);if(this.pending)return;this._key=await this._generateKey();const p=this._formatRequest({method:"wc_sessionRequest",params:[{peerId:this.clientId,peerMeta:this.clientMeta,chainId:s&&s.chainId?s.chainId:null}]});this.handshakeId=p.id,this.handshakeTopic=me(),this._sendSessionRequest(p,"Session update rejected",{topic:this.handshakeTopic}),this._eventManager.trigger({event:"display_uri",params:[this.uri]})}approveSession(s){if(this._connected)throw new Error(ye);this.chainId=s.chainId,this.accounts=s.accounts,this.networkId=s.networkId||0,this.rpcUrl=s.rpcUrl||"";const p={approved:!0,chainId:this.chainId,networkId:this.networkId,accounts:this.accounts,rpcUrl:this.rpcUrl,peerId:this.clientId,peerMeta:this.clientMeta},w={id:this.handshakeId,jsonrpc:"2.0",result:p};this._sendResponse(w),this._connected=!0,this._setStorageSession(),this._eventManager.trigger({event:"connect",params:[{peerId:this.peerId,peerMeta:this.peerMeta,chainId:this.chainId,accounts:this.accounts}]})}rejectSession(s){if(this._connected)throw new Error(ye);const p=s&&s.message?s.message:fi,w=this._formatResponse({id:this.handshakeId,error:{message:p}});this._sendResponse(w),this._connected=!1,this._eventManager.trigger({event:"disconnect",params:[{message:p}]}),this._removeStorageSession()}updateSession(s){if(!this._connected)throw new Error(qt);this.chainId=s.chainId,this.accounts=s.accounts,this.networkId=s.networkId||0,this.rpcUrl=s.rpcUrl||"";const p={approved:!0,chainId:this.chainId,networkId:this.networkId,accounts:this.accounts,rpcUrl:this.rpcUrl},w=this._formatRequest({method:"wc_sessionUpdate",params:[p]});this._sendSessionRequest(w,"Session update rejected"),this._eventManager.trigger({event:"session_update",params:[{chainId:this.chainId,accounts:this.accounts}]}),this._manageStorageSession()}async killSession(s){const p=s?s.message:"Session Disconnected",w={approved:!1,chainId:null,networkId:null,accounts:null},b=this._formatRequest({method:"wc_sessionUpdate",params:[w]});await this._sendRequest(b),this._handleSessionDisconnect(p)}async sendTransaction(s){if(!this._connected)throw new Error(qt);const p=ge(s),w=this._formatRequest({method:"eth_sendTransaction",params:[p]});return await this._sendCallRequest(w)}async signTransaction(s){if(!this._connected)throw new Error(qt);const p=ge(s),w=this._formatRequest({method:"eth_signTransaction",params:[p]});return await this._sendCallRequest(w)}async signMessage(s){if(!this._connected)throw new Error(qt);const p=this._formatRequest({method:"eth_sign",params:s});return await this._sendCallRequest(p)}async signPersonalMessage(s){if(!this._connected)throw new Error(qt);s=Ce(s);const p=this._formatRequest({method:"personal_sign",params:s});return await this._sendCallRequest(p)}async signTypedData(s){if(!this._connected)throw new Error(qt);const p=this._formatRequest({method:"eth_signTypedData",params:s});return await this._sendCallRequest(p)}async updateChain(s){if(!this._connected)throw new Error("Session currently disconnected");const p=this._formatRequest({method:"wallet_updateChain",params:[s]});return await this._sendCallRequest(p)}unsafeSend(s,p){return this._sendRequest(s,p),this._eventManager.trigger({event:"call_request_sent",params:[{request:s,options:p}]}),new Promise((w,b)=>{this._subscribeToResponse(s.id,(m,P)=>{if(m){b(m);return}if(!P)throw new Error(ui);w(P)})})}async sendCustomRequest(s,p){if(!this._connected)throw new Error(qt);switch(s.method){case"eth_accounts":return this.accounts;case"eth_chainId":return Qe(this.chainId);case"eth_sendTransaction":case"eth_signTransaction":s.params&&(s.params[0]=ge(s.params[0]));break;case"personal_sign":s.params&&(s.params=Ce(s.params));break}const w=this._formatRequest(s);return await this._sendCallRequest(w,p)}approveRequest(s){if(Dt(s)){const p=this._formatResponse(s);this._sendResponse(p)}else throw new Error(ci)}rejectRequest(s){if(Jt(s)){const p=this._formatResponse(s);this._sendResponse(p)}else throw new Error(li)}transportClose(){this._transport.close()}async _sendRequest(s,p){const w=this._formatRequest(s),b=await this._encrypt(w),m=typeof(p==null?void 0:p.topic)<"u"?p.topic:this.peerId,P=JSON.stringify(b),x=typeof(p==null?void 0:p.forcePushNotification)<"u"?!p.forcePushNotification:Qr(w);this._transport.send(P,m,x)}async _sendResponse(s){const p=await this._encrypt(s),w=this.peerId,b=JSON.stringify(p),m=!0;this._transport.send(b,w,m)}async _sendSessionRequest(s,p,w){this._sendRequest(s,w),this._subscribeToSessionResponse(s.id,p)}_sendCallRequest(s,p){return this._sendRequest(s,p),this._eventManager.trigger({event:"call_request_sent",params:[{request:s,options:p}]}),this._subscribeToCallResponse(s.id)}_formatRequest(s){if(typeof s.method>"u")throw new Error(di);return{id:typeof s.id>"u"?Wr():s.id,jsonrpc:"2.0",method:s.method,params:typeof s.params>"u"?[]:s.params}}_formatResponse(s){if(typeof s.id>"u")throw new Error(pi);const p={id:s.id,jsonrpc:"2.0"};if(Jt(s)){const w=Xr(s.error);return Object.assign(Object.assign(Object.assign({},p),s),{error:w})}else if(Dt(s))return Object.assign(Object.assign({},p),s);throw new Error(Ne)}_handleSessionDisconnect(s){const p=s||"Session Disconnected";this._connected||(this._qrcodeModal&&this._qrcodeModal.close(),$e(Fe)),this._connected&&(this._connected=!1),this._handshakeId&&(this._handshakeId=0),this._handshakeTopic&&(this._handshakeTopic=""),this._peerId&&(this._peerId=""),this._eventManager.trigger({event:"disconnect",params:[{message:p}]}),this._removeStorageSession(),this.transportClose()}_handleSessionResponse(s,p){p?p.approved?(this._connected?(p.chainId&&(this.chainId=p.chainId),p.accounts&&(this.accounts=p.accounts),this._eventManager.trigger({event:"session_update",params:[{chainId:this.chainId,accounts:this.accounts}]})):(this._connected=!0,p.chainId&&(this.chainId=p.chainId),p.accounts&&(this.accounts=p.accounts),p.peerId&&!this.peerId&&(this.peerId=p.peerId),p.peerMeta&&!this.peerMeta&&(this.peerMeta=p.peerMeta),this._eventManager.trigger({event:"connect",params:[{peerId:this.peerId,peerMeta:this.peerMeta,chainId:this.chainId,accounts:this.accounts}]})),this._manageStorageSession()):this._handleSessionDisconnect(s):this._handleSessionDisconnect(s)}async _handleIncomingMessages(s){if(![this.clientId,this.handshakeTopic].includes(s.topic))return;let w;try{w=JSON.parse(s.payload)}catch{return}const b=await this._decrypt(w);b&&this._eventManager.trigger(b)}_subscribeToSessionRequest(){this._transport.subscribe(this.handshakeTopic)}_subscribeToResponse(s,p){this.on(`response:${s}`,p)}_subscribeToSessionResponse(s,p){this._subscribeToResponse(s,(w,b)=>{if(w){this._handleSessionResponse(w.message);return}Dt(b)?this._handleSessionResponse(p,b.result):b.error&&b.error.message?this._handleSessionResponse(b.error.message):this._handleSessionResponse(p)})}_subscribeToCallResponse(s){return new Promise((p,w)=>{this._subscribeToResponse(s,(b,m)=>{if(b){w(b);return}Dt(m)?p(m.result):m.error&&m.error.message?w(m.error):w(new Error(Ne))})})}_subscribeToInternalEvents(){this.on("display_uri",()=>{this._qrcodeModal&&this._qrcodeModal.open(this.uri,()=>{this._eventManager.trigger({event:"modal_closed",params:[]})},this._qrcodeModalOptions)}),this.on("connect",()=>{this._qrcodeModal&&this._qrcodeModal.close()}),this.on("call_request_sent",(s,p)=>{const{request:w}=p.params[0];if(cr()&&this._signingMethods.includes(w.method)){const b=Pe(Fe);b&&(window.location.href=b.href)}}),this.on("wc_sessionRequest",(s,p)=>{s&&this._eventManager.trigger({event:"error",params:[{code:"SESSION_REQUEST_ERROR",message:s.toString()}]}),this.handshakeId=p.id,this.peerId=p.params[0].peerId,this.peerMeta=p.params[0].peerMeta;const w=Object.assign(Object.assign({},p),{method:"session_request"});this._eventManager.trigger(w)}),this.on("wc_sessionUpdate",(s,p)=>{s&&this._handleSessionResponse(s.message),this._handleSessionResponse("Session disconnected",p.params[0])})}_initTransport(){this._transport.on("message",s=>this._handleIncomingMessages(s)),this._transport.on("open",()=>this._eventManager.trigger({event:"transport_open",params:[]})),this._transport.on("close",()=>this._eventManager.trigger({event:"transport_close",params:[]})),this._transport.on("error",()=>this._eventManager.trigger({event:"transport_error",params:["Websocket connection failed"]})),this._transport.open()}_formatUri(){const s=this.protocol,p=this.handshakeTopic,w=this.version,b=encodeURIComponent(this.bridge),m=this.key;return`${s}:${p}@${w}?bridge=${b}&key=${m}`}_parseUri(s){const p=ni(s);if(p.protocol===this.protocol){if(!p.handshakeTopic)throw Error("Invalid or missing handshakeTopic parameter value");const w=p.handshakeTopic;if(!p.bridge)throw Error("Invalid or missing bridge url parameter value");const b=decodeURIComponent(p.bridge);if(!p.key)throw Error("Invalid or missing key parameter value");const m=p.key;return{handshakeTopic:w,bridge:b,key:m}}else throw new Error(gi)}async _generateKey(){return this._cryptoLib?await this._cryptoLib.generateKey():null}async _encrypt(s){const p=this._key;return this._cryptoLib&&p?await this._cryptoLib.encrypt(s,p):null}async _decrypt(s){const p=this._key;return this._cryptoLib&&p?await this._cryptoLib.decrypt(s,p):null}_getStorageSession(){let s=null;return this._sessionStorage&&(s=this._sessionStorage.getSession()),s}_setStorageSession(){this._sessionStorage&&this._sessionStorage.setSession(this.session)}_removeStorageSession(){this._sessionStorage&&this._sessionStorage.removeSession()}_manageStorageSession(){this._connected?this._setStorageSession():this._removeStorageSession()}_registerPushServer(s){if(!s.url||typeof s.url!="string")throw Error("Invalid or missing pushServerOpts.url parameter value");if(!s.type||typeof s.type!="string")throw Error("Invalid or missing pushServerOpts.type parameter value");if(!s.token||typeof s.token!="string")throw Error("Invalid or missing pushServerOpts.token parameter value");const p={bridge:this.bridge,topic:this.clientId,type:s.type,token:s.token,peerName:"",language:s.language||""};this.on("connect",async(w,b)=>{if(w)throw w;if(s.peerMeta){const m=b.params[0].peerMeta.name;p.peerName=m}try{if(!(await(await fetch(`${s.url}/new`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(p)})).json()).success)throw Error("Failed to register in Push Server")}catch{throw Error("Failed to register in Push Server")}})}}function ki(u){return jt.getBrowerCrypto().getRandomValues(new Uint8Array(u))}const tr=256,er=tr,Ai=tr,Ot="AES-CBC",Ti=`SHA-${er}`,ve="HMAC",Ui="encrypt",Fi="decrypt",Oi="sign",qi="verify";function Ci(u){return u===Ot?{length:er,name:Ot}:{hash:{name:Ti},name:ve}}function Ni(u){return u===Ot?[Ui,Fi]:[Oi,qi]}async function be(u,s=Ot){return jt.getSubtleCrypto().importKey("raw",u,Ci(s),!0,Ni(s))}async function Li(u,s,p){const w=jt.getSubtleCrypto(),b=await be(s,Ot),m=await w.encrypt({iv:u,name:Ot},b,p);return new Uint8Array(m)}async function Pi(u,s,p){const w=jt.getSubtleCrypto(),b=await be(s,Ot),m=await w.decrypt({iv:u,name:Ot},b,p);return new Uint8Array(m)}async function $i(u,s){const p=jt.getSubtleCrypto(),w=await be(u,ve),b=await p.sign({length:Ai,name:ve},w,s);return new Uint8Array(b)}function Di(u,s,p){return Li(u,s,p)}function Hi(u,s,p){return Pi(u,s,p)}async function rr(u,s){return await $i(u,s)}async function ir(u){const s=(u||256)/8,p=ki(s);return $r(Kt(p))}async function nr(u,s){const p=Nt(u.data),w=Nt(u.iv),b=Nt(u.hmac),m=Ct(b,!1),P=ze(p,w),x=await rr(s,P),$=Ct(x,!1);return Ft(m)===Ft($)}async function ji(u,s,p){const w=Lt(we(s)),b=p||await ir(128),m=Lt(we(b)),P=Ct(m,!1),x=JSON.stringify(u),$=Tr(x),Mt=await Di(m,w,$),Bt=Ct(Mt,!1),It=ze(Mt,m),Et=await rr(w,It),xt=Ct(Et,!1);return{data:Bt,hmac:xt,iv:P}}async function Zi(u,s){const p=Lt(we(s));if(!p)throw new Error("Missing key: required for decryption");if(!await nr(u,p))return null;const b=Nt(u.data),m=Nt(u.iv),P=await Hi(m,p,b),x=kr(P);let $;try{$=JSON.parse(x)}catch{return null}return $}const Wi=Object.freeze(Object.defineProperty({__proto__:null,decrypt:Zi,encrypt:ji,generateKey:ir,verifyHmac:nr},Symbol.toStringTag,{value:"Module"}));class Ki extends Bi{constructor(s,p){super({cryptoLib:Wi,connectorOpts:s,pushServerOpts:p})}}export{Ki as default};
