import{c4 as f}from"./vendor-d591a884.js";import{e as l}from"./events-b1394630.js";function p(r,s){for(var a=0;a<s.length;a++){const e=s[a];if(typeof e!="string"&&!Array.isArray(e)){for(const n in e)if(n!=="default"&&!(n in r)){const o=Object.getOwnPropertyDescriptor(e,n);o&&Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:()=>e[n]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var g={},d={},u={};Object.defineProperty(u,"__esModule",{value:!0});u.getLowerCase=void 0;function m(r){return r&&r.toLowerCase()}u.getLowerCase=m;Object.defineProperty(d,"__esModule",{value:!0});d.SafeAppProvider=void 0;const _=l,c=u;class k extends _.EventEmitter{constructor(s,a){super(),this.submittedTxs=new Map,this.safe=s,this.sdk=a}async connect(){this.emit("connect",{chainId:this.chainId})}async disconnect(){}get chainId(){return this.safe.chainId}async request(s){const{method:a,params:e=[]}=s;switch(a){case"eth_accounts":return[this.safe.safeAddress];case"net_version":case"eth_chainId":return`0x${this.chainId.toString(16)}`;case"personal_sign":{const[t,i]=e;if(this.safe.safeAddress.toLowerCase()!==i.toLowerCase())throw new Error("The address or message hash is invalid");return await this.sdk.txs.signMessage(t),"0x"}case"eth_sign":{const[t,i]=e;if(this.safe.safeAddress.toLowerCase()!==t.toLowerCase()||!i.startsWith("0x"))throw new Error("The address or message hash is invalid");return await this.sdk.txs.signMessage(i),"0x"}case"eth_sendTransaction":const n=Object.assign({value:"0",data:"0x"},e[0]),o=await this.sdk.txs.send({txs:[n]});return this.submittedTxs.set(o.safeTxHash,{from:this.safe.safeAddress,hash:o.safeTxHash,gas:0,gasPrice:"0x00",nonce:0,input:n.data,value:n.value,to:n.to,blockHash:null,blockNumber:null,transactionIndex:null}),o.safeTxHash;case"eth_blockNumber":return(await this.sdk.eth.getBlockByNumber(["latest"])).number;case"eth_getBalance":return this.sdk.eth.getBalance([(0,c.getLowerCase)(e[0]),e[1]]);case"eth_getCode":return this.sdk.eth.getCode([(0,c.getLowerCase)(e[0]),e[1]]);case"eth_getTransactionCount":return this.sdk.eth.getTransactionCount([(0,c.getLowerCase)(e[0]),e[1]]);case"eth_getStorageAt":return this.sdk.eth.getStorageAt([(0,c.getLowerCase)(e[0]),e[1],e[2]]);case"eth_getBlockByNumber":return this.sdk.eth.getBlockByNumber([e[0],e[1]]);case"eth_getBlockByHash":return this.sdk.eth.getBlockByHash([e[0],e[1]]);case"eth_getTransactionByHash":let h=e[0];try{h=(await this.sdk.txs.getBySafeTxHash(h)).txHash||h}catch{}return this.submittedTxs.has(h)?this.submittedTxs.get(h):this.sdk.eth.getTransactionByHash([h]).then(t=>(t&&(t.hash=e[0]),t));case"eth_getTransactionReceipt":{let t=e[0];try{t=(await this.sdk.txs.getBySafeTxHash(t)).txHash||t}catch{}return this.sdk.eth.getTransactionReceipt([t]).then(i=>(i&&(i.transactionHash=e[0]),i))}case"eth_estimateGas":return this.sdk.eth.getEstimateGas(e[0]);case"eth_call":return this.sdk.eth.call([e[0],e[1]]);case"eth_getLogs":return this.sdk.eth.getPastLogs([e[0]]);case"eth_gasPrice":return this.sdk.eth.getGasPrice();default:throw Error(`"${s.method}" not implemented`)}}send(s,a){s||a("Undefined request"),this.request(s).then(e=>a(null,{jsonrpc:"2.0",id:s.id,result:e})).catch(e=>a(e,null))}}d.SafeAppProvider=k;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SafeAppProvider=void 0;var s=d;Object.defineProperty(r,"SafeAppProvider",{enumerable:!0,get:function(){return s.SafeAppProvider}})})(g);const v=f(g),y=p({__proto__:null,default:v},[g]);export{y as i};
